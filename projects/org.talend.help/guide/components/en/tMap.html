<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>tMap</title><meta name="generator" content="DocBook XSL-NS Stylesheets V1.76.1"><link rel="home" href="index.html" title="Talend Open Studio"><link rel="up" href="ch15.html" title="Chapter&nbsp;15.&nbsp;Processing components"><link rel="prev" href="tJoin.html" title="tJoin"><link rel="next" href="tNormalize.html" title="tNormalize"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div lang="EN" class="section" title="tMap"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="tMap"></a>tMap</h2></div></div></div><div class="mediaobject"><img src="../images/tMap.png"></div><div class="section" title="tMap properties"><div class="titlepage"><div><div><h3 class="title"><a name="d0e250285"></a>tMap properties</h3></div></div></div><div class="informaltable"><table border="1"><colgroup><col class="c1"><col class="c2"><col class="c3"></colgroup><tbody><tr><td valign="top">
									<p>
										<span class="bold"><strong>Component family</strong></span>
									</p>
								</td><td valign="top">
									<p>Processing</p>
								</td><td valign="top">&nbsp;</td></tr><tr><td valign="top">
									<p>
										<span class="bold"><strong>Function</strong></span>
									</p>
								</td><td colspan="2" valign="top">
									<p><span class="bold"><strong>tMap</strong></span> is an advanced
										component, which integrates itself as plugin to <span class="bluebold">Talend Open Studio</span>.</p>
								</td></tr><tr><td valign="top">
									<p>
										<span class="bold"><strong>Purpose</strong></span>
									</p>
								</td><td colspan="2" valign="top">
									<p><span class="bold"><strong>tMap</strong></span> transforms and
										routes data from single or multiple sources to single or
										multiple destinations. </p>
								</td></tr><tr><td valign="top">
									<p>
										<span class="bold"><strong>Basic settings</strong></span>
									</p>
								</td><td valign="top">
									<p>
										<span class="emphasis"><em>Preview</em></span>
									</p>
								</td><td valign="top">
									<p>The preview is an instant shot of the Mapper data. It
										becomes available when Mapper properties have been filled in
										with data. The preview synchronization takes effect only
										after saving changes.</p>
								</td></tr><tr><td>
									<p>&nbsp;</p>
								</td><td valign="top">
									<p>
										<span class="emphasis"><em>Mapping links display as</em></span>
									</p>
								</td><td valign="top">
									<p><span class="bold"><strong>Auto</strong></span>: the default setting
										is curves links</p>
									<p>
										<span class="bold"><strong>Curves</strong></span>: the mapping display
										as curves </p>
									<p>
										<span class="bold"><strong>Lines</strong></span>: the mapping displays
										as straight lines. This last option allows to slightly
										enhance performance. </p>
								</td></tr><tr><td>
									<p>&nbsp;</p>
								</td><td valign="top">
									<p>
										<span class="emphasis"><em>Map editor</em></span>
									</p>
								</td><td valign="top">
									<p>It allows you to define the <span class="bold"><strong>tMap</strong></span> routing and transformation
										properties.</p>
									<p> </p>
									<div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="16pt"><img alt="[Note]" src="../images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>If you do not want to handle execution errors, you can
											click the <span class="bold"><strong>Property
												Settings</strong></span> button at the top of the input
											area and select the <span class="bold"><strong>Die on error
											</strong></span>check box (selected by default) in the
												<span class="bold"><strong>[Property Settings]</strong></span>
											dialog box. It will kill the Job if there is an
											error.</p></td></tr></table></div>


								</td></tr><tr><td valign="top">
									<p>
										<span class="bold"><strong>Usage</strong></span>
									</p>
								</td><td colspan="2" valign="top">
									<p>Possible uses are from a simple reorganization of fields
										to the most complex Jobs of data multiplexing or
										demultiplexing transformation, concatenation, inversion,
										filtering and more...</p>
								</td></tr><tr><td valign="top">
									<p>
										<span class="bold"><strong>Limitation</strong></span>
									</p>
								</td><td colspan="2" valign="top">
									<p>The use of <span class="bold"><strong>tMap</strong></span> supposes
										minimum Java knowledge in order to fully exploit its
										functionalities.</p>
									<p> This component is a junction step, and for this reason
										cannot be a start nor end component in the Job.</p>
								</td></tr></tbody></table></div><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="16pt"><img alt="[Note]" src="../images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>For further information, see <span class="bluebold">Talend Open Studio</span>
						<span class="bold"><strong>User Guide</strong></span>.</p></td></tr></table></div></div><div class="section" title="Scenario 1: Mapping data using a filter and a simple explicit join"><div class="titlepage"><div><div><h3 class="title"><a name="processing-tmap-scenario-explicit_join"></a>Scenario 1: Mapping data using a filter and a simple explicit join</h3></div></div></div><p>The Job described below aims at reading data from a csv file with its schema
					stored in the Repository, looking up at a reference file, the schema of which is
					also stored in the Repository, then extracting data from these two files based
					on a defined filter to an output file and reject files. </p><div class="mediaobject"><img src="../images/UseCase_tMap2-1-1.png"></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Click <span class="bold"><strong>File</strong></span> in the <span class="bold"><strong>Palette</strong></span> of components, select <span class="bold"><strong>tFileInputDelimited</strong></span> and drop it onto the
							design workspace. Rename the component <span class="emphasis"><em>Cars</em></span>, either
							by double-clicking the label in the design workspace or via the
								<span class="bold"><strong>View</strong></span> tab of the <span class="bold"><strong>Component</strong></span> view.</p></li><li class="listitem"><p>Repeat this operation, and rename this second input component
								<span class="emphasis"><em>Owners</em></span>. </p></li><li class="listitem"><p>Click <span class="bold"><strong>Processing</strong></span> in the <span class="bold"><strong>Palette</strong></span> of components, select <span class="bold"><strong>tMap</strong></span> and drop it onto the design workspace.
						</p></li><li class="listitem"><p>Connect the two input components to the mapping component using
								<span class="bold"><strong>Row</strong></span> &gt; <span class="bold"><strong>Main</strong></span> connections and label the connections
								<span class="emphasis"><em>Cars_data</em></span> and <span class="emphasis"><em>Owners_data</em></span>
							respectively.</p></li><li class="listitem"><p>Double-click the <span class="bold"><strong>tFileInputDelimited</strong></span>
							component labelled <span class="emphasis"><em>Cars</em></span> to display its <span class="bold"><strong>Basic settings </strong></span>view.</p></li></ul></div><div class="mediaobject"><img src="../images/UseCase_tMap2-1-2.png"></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Select <span class="bold"><strong>Repository</strong></span> from the <span class="bold"><strong>Property type</strong></span> list and select the component&#8217;s
							schema, <span class="emphasis"><em>cars</em></span> in this scenario, from the <span class="bold"><strong>[Repository Content]</strong></span> dialog box. The rest
							fields are automatically filled.</p></li><li class="listitem"><p>Double-click the component labelled <span class="emphasis"><em>Owners</em></span> and
							repeat the setting operation. Select the appropriate metadata entry,
								<span class="emphasis"><em>owners</em></span> in this scenario.</p></li></ul></div><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="16pt"><img alt="[Note]" src="../images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>In this scenario, the input schemas are stored in the <span class="bold"><strong>Metadata</strong></span> node of the <span class="bold"><strong>Repository</strong></span> tree view for easy retrieval. For further
						information regarding metadata creation in the Repository, see <span class="bluebold">Talend Open Studio</span>
						<span class="bold"><strong>User Guide</strong></span>.</p></td></tr></table></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Double-click the <span class="bold"><strong>tMap</strong></span> component to
							open the <span class="bold"><strong>Map Editor</strong></span>. </p><p> Note that the input area is already filled with the defined input
							tables and that the top table is the main input table, and the
							respective row connection labels are displayed on the top bar of the
							table. </p></li><li class="listitem"><p>Create a join between the two tables on the
								<span class="emphasis"><em>ID_Owner</em></span> column by simply dropping the
								<span class="emphasis"><em>ID_Owner</em></span> column from the
								<span class="emphasis"><em>Cars_data</em></span> table onto the
								<span class="emphasis"><em>ID_Owner</em></span> column in the
								<span class="emphasis"><em>Owners_data</em></span> table. </p></li><li class="listitem"><p>Define this join as an inner join by clicking the <span class="bold"><strong>tMap settings</strong></span> button, clicking in the
								<span class="bold"><strong>Value</strong></span> field for <span class="bold"><strong>Join Model</strong></span>, clicking the small button that
							appears in the field, and selecting <span class="bold"><strong>Inner Join
							</strong></span>from the <span class="bold"><strong>[Options]</strong></span> dialog
							box. </p></li></ul></div><div class="mediaobject"><img src="../images/UseCase_tmap2-1-3.png"></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Click the <span class="bold"><strong>[+]</strong></span> button on the output
							area of the <span class="bold"><strong>Map Editor</strong></span> to add three
							output tables: <span class="emphasis"><em>Insured</em></span>,
								<span class="emphasis"><em>Reject_NoInsur</em></span>,
								<span class="emphasis"><em>Reject_OwnerID</em></span>.</p></li><li class="listitem"><p>Drag all the columns of the <span class="emphasis"><em>Cars_data</em></span> table to
							the <span class="emphasis"><em>Insured</em></span> table. </p></li><li class="listitem"><p> Drag the <span class="emphasis"><em>ID_Owner</em></span>,
								<span class="emphasis"><em>Registration</em></span>, and
								<span class="emphasis"><em>ID_Reseller</em></span> columns of the
								<span class="emphasis"><em>Cars_data</em></span> table and the
								<span class="emphasis"><em>Name</em></span> column of the
								<span class="emphasis"><em>Owners_data</em></span> table to the
								<span class="emphasis"><em>Reject_NoInsur</em></span> table.</p></li><li class="listitem"><p>Drag all the columns of the <span class="emphasis"><em>Cars_data</em></span> table to
							the <span class="emphasis"><em>Reject_OwnerID</em></span> table. </p><p> For more information regarding data mapping, see <span class="bluebold">Talend Open Studio</span>
							<span class="bold"><strong>User Guide</strong></span>.</p></li><li class="listitem"><p>Click the plus arrow button at the top of the
								<span class="emphasis"><em>Insured</em></span> table to add a filter row.</p></li><li class="listitem"><p>Drag the <span class="emphasis"><em>ID_Insurance</em></span> column of the
								<span class="emphasis"><em>Owners_data</em></span> table to the filter condition area
							and enter the formula meaning &#8216;not undefined&#8217;:
								<code class="code">Owners_data.ID_Insurance != null.</code>
						</p><p> With this filter, the <span class="emphasis"><em>Insured</em></span> table will gather
							all the records that include an insurance ID.</p></li></ul></div><div class="mediaobject"><img src="../images/UseCase_tMap2-1-4.png"></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Click the <span class="bold"><strong>tMap settings</strong></span> button at the
							top of the <span class="emphasis"><em>Reject_NoInsur</em></span> table and set <span class="bold"><strong>Catch output reject</strong></span> to <span class="bold"><strong>true</strong></span> to define the table as a standard reject output
							flow to gather the records that do not include an insurance ID.</p></li></ul></div><div class="mediaobject"><img src="../images/use_case-tmap2-1-5halftop.png"></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Click the <span class="bold"><strong>tMap settings</strong></span> button at the
							top of the <span class="emphasis"><em>Reject_OwnerID</em></span> table and set <span class="bold"><strong>Catch lookup inner join reject</strong></span> to <span class="bold"><strong>true</strong></span> so that this output table will gather
							the records from the <span class="emphasis"><em>Cars_data</em></span> flow with missing or
							unmatched owner IDs.</p></li></ul></div><div class="mediaobject"><img src="../images/use_case-tmap2-1-5halfbot.png"></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Click <span class="bold"><strong>OK</strong></span> to validate the mappings and
							close the <span class="bold"><strong>Map Editor</strong></span>.</p></li><li class="listitem"><p>Add three <span class="bold"><strong>tFileOutputDelimited</strong></span>
							components to the design workspace and connect the <span class="bold"><strong>tMap</strong></span> component to the three output components using the
							relevant <span class="bold"><strong>Row</strong></span> connections. </p></li><li class="listitem"><p>Relabel the three output components accordingly.</p></li><li class="listitem"><p>Double-click each of the output components, one after the other, to
							define their properties. If you want a new file to be created, browse to
							the destination output folder, and type in a file name including the
							extension.</p></li><li class="listitem"><p>Select the <span class="bold"><strong>Include header</strong></span> check box
							to reuse the column labels from the schema as header row in the output
							file.</p></li></ul></div><div class="mediaobject"><img src="../images/UseCase_tMap2-1-6.png"></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Save your Job and press <span class="bold"><strong>F6</strong></span> to run
							it.</p><p> The output files are created, which contain the relevant data as
							defined. </p></li></ul></div><div class="mediaobject"><img src="../images/UseCase_tMap2-1-7.png"></div></div><div class="section" title="Scenario 2: Mapping data using inner join rejections"><div class="titlepage"><div><div><h3 class="title"><a name="d0e250838"></a>Scenario 2: Mapping data using inner join rejections</h3></div></div></div><p>This scenario, based on scenario 1, adds one input file containing details
					about resellers and extra fields in the main output table. Two filters on inner
					joins are added to gather specific rejections.</p><div class="mediaobject"><img src="../images/UseCase_tmap2-2-2.png"></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Click <span class="bold"><strong>File</strong></span> in the <span class="bold"><strong>Palette</strong></span> of Components, and drop a <span class="bold"><strong>tFileInputDelimited</strong></span> component to the design
							workspace, and label the component <span class="emphasis"><em>Resellers</em></span>.
						</p></li><li class="listitem"><p>Connect it to the Mapper using a <span class="bold"><strong>Row</strong></span>
							&gt; <span class="bold"><strong>Main</strong></span> connection, and label the
							connection <span class="emphasis"><em>Resellers_data</em></span>.</p></li><li class="listitem"><p>Double-click the <span class="emphasis"><em>Resellers</em></span> component to display
							its <span class="bold"><strong>Basic settings</strong></span> view.</p></li></ul></div><div class="mediaobject"><img src="../images/UseCase_tmap2-2-1.png"></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Select <span class="bold"><strong>Repository</strong></span> from the <span class="bold"><strong>Property type</strong></span> list and select the component&#8217;s
							schema, <span class="emphasis"><em>resellers</em></span> in this scenario, from the
								<span class="bold"><strong>[Repository Content]</strong></span> dialog box.
							The rest fields are automatically filled.</p></li></ul></div><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="16pt"><img alt="[Note]" src="../images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>In this scenario, the input schemas are stored in the <span class="bold"><strong>Metadata</strong></span> node of the <span class="bold"><strong>Repository</strong></span> tree view for easy retrieval. For further
						information regarding metadata creation in the Repository, see <span class="bluebold">Talend Open Studio</span>
						<span class="bold"><strong>User Guide</strong></span>.</p></td></tr></table></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Double-click the <span class="bold"><strong>tMap</strong></span> component to
							open the <span class="bold"><strong>Map Editor</strong></span>. </p><p> Note that the schema of the new input component is already added in
							the Input area.</p></li><li class="listitem"><p>Create a join between the main input flow and the new input flow by
							dropping the <span class="emphasis"><em>ID_Reseller</em></span> column of the
								<span class="emphasis"><em>Cars_data</em></span> table to the
								<span class="emphasis"><em>ID_Reseller</em></span> column of the
								<span class="emphasis"><em>Resellers_data</em></span> table.</p></li><li class="listitem"><p>Click the <span class="bold"><strong>tMap settings</strong></span> button at the
							top of the <span class="emphasis"><em>Resellers_data</em></span> table and set <span class="bold"><strong>Join Model</strong></span> to <span class="bold"><strong>Inner
								Join</strong></span>.</p></li></ul></div><div class="mediaobject"><img src="../images/UseCase_tmap2-2-3.png"></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Drag all the columns except <span class="emphasis"><em>ID_Reseller</em></span> of the
								<span class="emphasis"><em>Resellers_data</em></span> table to the main output table,
								<span class="emphasis"><em>Insured</em></span>.</p></li></ul></div><div class="mediaobject"><img src="../images/UseCase_tmap2-2-4.png"></div><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="16pt"><img alt="[Note]" src="../images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>When two inner joins are defined, you either need to define two different
						inner join reject tables to differentiate the two rejections or, if there is
						only one inner join reject output, both inner join rejections will be stored
						in the same output.</p></td></tr></table></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Click the <span class="bold"><strong>[+]</strong></span> button at the top of
							the output area to add a new output table, and name this new output
							table <span class="emphasis"><em>Reject_ResellerID</em></span>.</p></li><li class="listitem"><p>Drag all the columns of the <span class="emphasis"><em>Cars_data</em></span> table to
							the <span class="emphasis"><em>Reject_ResellerID </em></span>table.</p></li><li class="listitem"><p>Click the <span class="bold"><strong>tMap settings</strong></span> button and
							select <span class="bold"><strong>Catch lookup inner join reject</strong></span>
							to <span class="bold"><strong>true</strong></span> to define this new output table
							as an inner join reject output.</p><p> If the defined inner join cannot be established, the information
							about the relevant cars will be gathered through this output
							flow.</p></li></ul></div><div class="mediaobject"><img src="../images/UseCase_tmap2-2-5.png"></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Now apply filters on the two Inner Join reject outputs, in order for
							to distinguish the two types of rejection.</p></li><li class="listitem"><p>In the first Inner Join output table,
								<span class="emphasis"><em>Reject_OwnerID</em></span>, click the plus arrow button to
							add a filter line and fill it with the following formula to gather only
							owner ID related rejection: <code class="code">Owners_data.ID_Owner==null</code>
						</p></li><li class="listitem"><p>In the second Inner Join output table,
								<span class="emphasis"><em>Reject_ResellerID</em></span>, repeat the same operation
							using the following formula:
								<code class="code">Resellers_data.ID_Reseller==null</code>
						</p></li></ul></div><div class="mediaobject"><img src="../images/UseCase_tmap2-2-6.png"></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Click <span class="bold"><strong>OK</strong></span> to validate the map settings
							and close the <span class="bold"><strong>Mapper Editor</strong></span>. </p></li><li class="listitem"><p>Drop a new <span class="bold"><strong>tFileOutputDelimited</strong></span>
							component from the <span class="bold"><strong>Palette</strong></span> to the
							design workspace, and label the component
								<span class="emphasis"><em>No_Reseller_ID</em></span>. </p></li><li class="listitem"><p>Define the properties of the new <span class="bold"><strong>tFileOutputDelimited</strong></span> component, as shown below.</p><p> In this use case, simple specify the output file path and select the
								<span class="bold"><strong>Include Header</strong></span> check box, and leave
							the other parameters as they are.</p></li></ul></div><div class="mediaobject"><img src="../images/UseCase_tmap2-2-7.png"></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Connect the <span class="bold"><strong>tMap</strong></span> component to the new
								<span class="bold"><strong>tFileOutputDelimited</strong></span> component by
							using the <span class="bold"><strong>Row</strong></span> connection named
								<span class="emphasis"><em>Reject_ResellerID</em></span>.</p></li><li class="listitem"><p>To demonstrate the work of the Mapper, in this example, remove
							reseller IDs <span class="emphasis"><em>5</em></span> and <span class="emphasis"><em>8</em></span> from the
							input file <span class="emphasis"><em>Resellers.csv</em></span>.</p></li><li class="listitem"><p>Save your Job and press <span class="bold"><strong>F6</strong></span> to run
							it.</p><p> The four output files are all created in the specified folder,
							containing information as defined. The output file
								<span class="emphasis"><em>No_Reseller_ID.csv</em></span> contains the
								<span class="emphasis"><em>cars</em></span> information related to reseller IDs
								<span class="emphasis"><em>5</em></span> and <span class="emphasis"><em>8</em></span>, which are missing
							in the input file <span class="emphasis"><em>Resellers.csv</em></span>.</p></li></ul></div><div class="mediaobject"><img src="../images/UseCase_tmap2-2-8.png"></div></div><div class="section" title="Scenario 3: Cascading join mapping"><div class="titlepage"><div><div><h3 class="title"><a name="d0e251133"></a>Scenario 3: Cascading join mapping</h3></div></div></div><p>As third advanced use scenario, based on the scenario 2, add a new Input table
					containing Insurance details for example. </p><p>Set up an Inner Join between two lookup input tables (Owners and Insurance) in
					the Mapper to create a cascade lookup and hence retrieve Insurance details via
					the Owners table data.</p></div><div class="section" title="Scenario 4: Advanced mapping using filters, explicit joins and rejections"><div class="titlepage"><div><div><h3 class="title"><a name="Raa32575"></a>Scenario 4: Advanced mapping using filters, explicit joins and
					rejections</h3></div></div></div><p>This scenario introduces a Job that allows you to find BMW owners who have two
					to six children (inclusive), for sales promotion purpose for example.</p><div class="mediaobject"><img src="../images/UseCase_tmap4-1.png"></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Drop three <span class="bold"><strong>tFileInputDelimited</strong></span>
							components, a <span class="bold"><strong>tMap</strong></span> component, and two
								<span class="bold"><strong>tFileOutputDelimited</strong></span> components
							from the <span class="bold"><strong>Palette</strong></span> onto the design
							workspace, and label them to best describe their functions.</p></li><li class="listitem"><p>Connect the input components to the <span class="bold"><strong>tMap</strong></span> using <span class="bold"><strong>Row</strong></span> &gt;
								<span class="bold"><strong>Main</strong></span> connections. </p><p> Pay attention to the file you connect first as it will automatically
							be set as <span class="bold"><strong>Main</strong></span> flow, and all the other
							connections will be <span class="bold"><strong>Lookup</strong></span> flows. In
							this example, the connection for the input component
								<span class="emphasis"><em>Owners</em></span> is the <span class="bold"><strong>Main</strong></span> flow.</p></li><li class="listitem"><p>Define the properties of each input components in the respective
								<span class="bold"><strong>Basic settings</strong></span> view. Define the
							properties of <span class="emphasis"><em>Owners</em></span>.</p></li></ul></div><div class="mediaobject"><img src="../images/UseCase_tmap4-2.png"></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Select <span class="bold"><strong>Repository</strong></span> from the <span class="bold"><strong>Property type</strong></span> list and select the component&#8217;s
							schema, <span class="emphasis"><em>owners</em></span> in this scenario, from the <span class="bold"><strong>[Repository Content]</strong></span> dialog box. The rest
							fields are automatically filled.</p></li></ul></div><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="16pt"><img alt="[Note]" src="../images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>In this scenario, the input schemas are stored in the <span class="bold"><strong>Metadata</strong></span> node of the <span class="bold"><strong>Repository</strong></span> tree view for easy retrieval. For further
						information regarding metadata creation in the Repository, see <span class="bluebold">Talend Open Studio</span>
						<span class="bold"><strong>User Guide</strong></span>.</p></td></tr></table></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>In the same way, set the properties of the other input components:
								<span class="emphasis"><em>Cars</em></span> and <span class="emphasis"><em>Resellers</em></span>. These
							two <span class="bold"><strong>Lookup</strong></span> flows will fill in secondary
							(lookup) tables in the input area of the <span class="bold"><strong>Map
								Editor</strong></span>.</p></li><li class="listitem"><p>Then double-click the <span class="bold"><strong>tMap</strong></span> component
							to launch the <span class="bold"><strong>Map Editor</strong></span> and define the
							mappings and filters.</p></li><li class="listitem"><p>Set an explicit join between the <span class="bold"><strong>Main</strong></span>
							flow <span class="emphasis"><em>Owner</em></span> and the <span class="bold"><strong>Lookup</strong></span> flow <span class="emphasis"><em>Cars</em></span> by dropping the
								<span class="emphasis"><em>ID_Owner</em></span> column of the
								<span class="emphasis"><em>Owners</em></span> table to the
								<span class="emphasis"><em>ID_Owner</em></span> column of the
								<span class="emphasis"><em>Cars</em></span> table.</p><p> The explicit join is displayed along with a hash key.</p></li></ul></div><div class="mediaobject"><img src="../images/use_case-tmap4-3cut2.png"></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>In the <span class="bold"><strong>Expr. Key</strong></span> field of the
								<span class="emphasis"><em>Make</em></span> column, type in a filter. In this use
							case, simply type in <code class="code">&#8220;BMW&#8221;</code> as the search is focused on the
							owners of this particular make. </p></li></ul></div><div class="mediaobject"><img src="../images/use_case-tmap4-3cut3top.png"></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Implement a cascading join between the two lookup tables
								<span class="emphasis"><em>Cars</em></span> and <span class="emphasis"><em>Resellers</em></span> on the
								<span class="emphasis"><em>ID_Reseller</em></span> column in order to retrieve
							resellers information. </p></li><li class="listitem"><p>As you want to reject the null values into a separate table and
							exclude them from the standard output, click the <span class="bold"><strong>tMap settings</strong></span> button and set <span class="bold"><strong>Join
								Model</strong></span> to <span class="bold"><strong>Inner Join</strong></span> in
							each of the <span class="bold"><strong>Lookup</strong></span> tables.</p></li></ul></div><div class="mediaobject"><img src="../images/use_case-tmap4-3cut3.png"></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>In the tMap settings, you can set <span class="bold"><strong>Match
								Model</strong></span> to <span class="bold"><strong>Unique match</strong></span>,
								<span class="bold"><strong>First match</strong></span>, or <span class="bold"><strong>All matches</strong></span>. In this use case, the <span class="bold"><strong>All matches</strong></span> option is selected. Thus if
							several matches are found in the Inner Join, i.e. rows matching the
							explicit join as well as the filter, all of them will be added to the
							output flow (either in rejection or the regular output). </p></li></ul></div><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="16pt"><img alt="[Note]" src="../images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>The<span class="bold"><strong> Unique match</strong></span> option functions as
							a<span class="bold"><strong> Last match</strong></span>. The <span class="bold"><strong>First match</strong></span> and <span class="bold"><strong>All matches</strong></span>
						options function as named.</p></td></tr></table></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>On the output area of the <span class="bold"><strong>Map Editor</strong></span>,
							click the plus button to add two tables, one for the full matches and
							the other for the rejections.</p></li><li class="listitem"><p>Drag all the columns of the <span class="emphasis"><em>Owners</em></span> table, the
								<span class="emphasis"><em>Registration</em></span>, <span class="emphasis"><em>Make</em></span> and
								<span class="emphasis"><em>Color</em></span> columns of the <span class="emphasis"><em>Cars</em></span>
							table, and the <span class="emphasis"><em>ID_Reseller</em></span> and
								<span class="emphasis"><em>Name_Reseller</em></span> columns of the
								<span class="emphasis"><em>Resellers</em></span> table to the main output
							table.</p></li><li class="listitem"><p>Drag all the columns of the <span class="emphasis"><em>Owners</em></span> table to the
							reject output table.</p></li><li class="listitem"><p>Click the <span class="bold"><strong>Filter</strong></span> button at the top of
							the main output table to display the <span class="bold"><strong>Filter</strong></span> expression area.</p></li><li class="listitem"><p>Type in a filter statement to narrow down the number of rows loaded in
							the main output flow. In this use case, the statement reads:
								<code class="code">Owners.Children_Nr &gt;= 2 &amp;&amp; Owners.Children_Nr &lt;=
								6</code>. </p></li><li class="listitem"><p>In the reject output table, click the <span class="bold"><strong>tMap
								settings</strong></span> button and set the reject types.</p></li><li class="listitem"><p>Set <span class="bold"><strong>Catch output reject</strong></span> to <span class="bold"><strong>true</strong></span> to collect data about BMW car owners who
							have less than two or more than six children.</p></li><li class="listitem"><p>Set <span class="bold"><strong>Catch lookup inner join reject</strong></span> to
								<span class="bold"><strong>true</strong></span> to collect data about owners
							of other car makes and owners for whom the reseller information is not
							found.</p></li></ul></div><div class="mediaobject"><img src="../images/UseCase_tmap4-3.png"></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Click <span class="bold"><strong>OK</strong></span> to validate the mappings and
							close the <span class="bold"><strong>Map Editor</strong></span>.</p></li><li class="listitem"><p>On the design workspace, right-click the <span class="bold"><strong>tMap</strong></span> and pull the respective output link to the relevant
							output components.</p></li><li class="listitem"><p>Define the properties of the output components in their respective
								<span class="bold"><strong>Basic settings</strong></span> view.</p><p> In this use case, simple specify the output file paths and select the
								<span class="bold"><strong>Include Header</strong></span> check box, and leave
							the other parameters as they are.</p></li></ul></div><div class="mediaobject"><img src="../images/UseCase_tmap4-4.png"></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Save you Job and press <span class="bold"><strong>F6</strong></span> to run
							it.</p><p> The main output file contains the information related to BMW owners
							who have two to six children, and the reject output file contains the
							information about the rest of the car owners.</p></li></ul></div><div class="mediaobject"><img src="../images/UseCase_tmap4-5.png"></div></div><div class="section" title="Scenario 5: Advanced mapping with filters and different rejections"><div class="titlepage"><div><div><h3 class="title"><a name="d0e251496"></a>Scenario 5: Advanced mapping with filters and different rejections</h3></div></div></div><p>This scenario is a modified version of the preceding scenario. It describes a
					Job that applies filters to limit the search to BMW and Mercedes owners who have
					two to six children and divides unmatched data into different reject output
					flows.</p><div class="mediaobject"><img src="../images/UseCase_tmap5-1.png"></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Take the same Job as in <a class="xref" href="tMap.html#Raa32575" title="Scenario 4: Advanced mapping using filters, explicit joins and rejections">the section called &#8220;Scenario 4: Advanced mapping using filters, explicit joins and
					rejections&#8221;</a>.</p></li><li class="listitem"><p>Drop a new <span class="bold"><strong>tFileOutputDelimited</strong></span>
							component from the <span class="bold"><strong>Palette</strong></span> on the
							design workspace, and name it <span class="emphasis"><em>Rejects_BMW_Mercedes</em></span>
							to present its functionality.</p></li><li class="listitem"><p>Connect the <span class="bold"><strong>tMap</strong></span> component to the new
							output component using a <span class="bold"><strong>Row</strong></span> connection
							and label the connection according to the functionality of the output
							component. </p><p> This connection label will appear as the name of the new output table
							in the <span class="bold"><strong>Map Editor</strong></span>.</p></li><li class="listitem"><p>Relabel the existing output connections and output components to
							reflect their functionality.</p><p> The existing output tables in the <span class="bold"><strong>Map
								Editor</strong></span> will be automatically renamed according to the
							connection labels. In this example, relabel the existing output
							connections <span class="emphasis"><em>BMW_Mercedes_withChildren</em></span> and
								<span class="emphasis"><em>Owners_Other_Makes</em></span> respectively.</p></li><li class="listitem"><p>Double-click the <span class="bold"><strong>tMap</strong></span> component to
							launch the <span class="bold"><strong>Map Editor</strong></span> to change the
							mappings and the filters.</p><p> Note that the output area contains a new, empty output table named
								<span class="emphasis"><em>Rejects_BMW_Mercedes</em></span>. You can adjust the
							position of the table by selecting it and clicking the <span class="bold"><strong>Up</strong></span> or <span class="bold"><strong>Down</strong></span>
							arrow button at the top of the output area.</p></li><li class="listitem"><p>Remove the <span class="bold"><strong>Expr. key</strong></span> filter
								(<span class="emphasis"><em>&#8220;BMW&#8221;</em></span>) from the <span class="emphasis"><em>Cars</em></span>
							table in the input area.</p></li><li class="listitem"><p>Click the <span class="bold"><strong>Filters</strong></span> button to display
							the <span class="bold"><strong>Filter</strong></span> field, and type in a new
							filter to limit the search to <span class="emphasis"><em>BMW</em></span> or
								<span class="emphasis"><em>Mercedes</em></span> car makes. The statement reads as
							follows: <code class="code">Cars.Make.equals("BMW") ||
								Cars.Make.equals("Mercedes")</code></p></li></ul></div><div class="mediaobject"><img src="../images/use_case-tmap5-2cut2.png"></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Select all the columns of the main output table and drop them down to
							the new output table.</p><p> Alternatively, you can also drag the corresponding columns from the
							relevant input tables to the new output table.</p></li><li class="listitem"><p>Click the <span class="bold"><strong>tMap settings</strong></span> button at the
							top of the new output table and set <span class="bold"><strong>Catch output
								reject</strong></span> to <span class="bold"><strong>true</strong></span> to
							collect data about BMW and Mercedes owners who have less than two or
							more than six children.</p></li><li class="listitem"><p>In the <span class="emphasis"><em>Owners_Other_Makes</em></span> table, set <span class="bold"><strong>Catch lookup inner join reject</strong></span> to <span class="bold"><strong>true</strong></span> to collect data about owners of other
							car makes and owners for whom the reseller information is not
							found.</p></li></ul></div><div class="mediaobject"><img src="../images/UseCase_tmap5-2.png"></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Click <span class="bold"><strong>OK</strong></span> to validate the mappings and
							close the <span class="bold"><strong>Map Editor</strong></span>.</p></li><li class="listitem"><p>Define the properties of the output components in their respective
								<span class="bold"><strong>Basic settings</strong></span> view.</p><p> In this use case, simple specify the output file paths and select the
								<span class="bold"><strong>Include Header</strong></span> check box, and leave
							the other parameters as they are.</p></li></ul></div><div class="mediaobject"><img src="../images/UseCase_tmap5-3.png"></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Save the Job and press <span class="bold"><strong>F6</strong></span> to run
							it.</p><p> The output files contain content of the main output flow shows that
							the filtered rows have correctly been passed on.</p></li></ul></div></div><div class="section" title="Scenario 6: Advanced mapping with lookup reload at each row"><div class="titlepage"><div><div><h3 class="title"><a name="Raa94325"></a>Scenario 6: Advanced mapping with lookup reload at each row</h3></div></div></div><p>The following scenario describes a Job that retrieves people details from a
					lookup database, based on a join on the age. The main flow source data is read
					from a MySQL database table called <span class="emphasis"><em>people_age</em></span> that contains
					people details such as numeric id, alphanumeric first name and last name and
					numeric age. The people age is either 40 or 60. The number of records in this
					table is intentionally restricted.</p><p>The reference or lookup information is also stored in a MySQL database table
					called <span class="emphasis"><em>large_data_volume</em></span>. This lookup table contains a
					number of records including the city where people from the main flow have been
					to. For the sake of clarity, the number of records is restricted but, in a
					normal use, the usefulness of the feature described in the example below is more
					obvious for very large reference data volume.</p><p>To optimize performance, a database connection component is used in the
					beginning of the Job to open the connection to the lookup database table in
					order not to do that every time we want to load a row from the lookup
					table.</p><p>An Expression Filter is applied to this lookup source flow, in order to select
					only data from people whose age is equal to 60 or 40. This way only the relevant
					rows from the lookup database table are loaded for each row from the main
					flow.</p><p>Therefore this Job shows how, from a limited number of main flow rows, the
					lookup join can be optimized to load only results matching the expression
					key.</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="16pt"><img alt="[Note]" src="../images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>Generally speaking, as the lookup loading is performed for each main flow
						row, this option is mainly interesting when a limited number of rows is
						processed in the main flow while a large number of reference rows are to be
						looked up to.</p></td></tr></table></div><p>The join is solved on the <span class="emphasis"><em>age</em></span> field. Then, using the
					relevant loading option in the <span class="bold"><strong>tMap</strong></span> component
					editor, the lookup database information is loaded for each main flow incoming
					row. </p><div class="mediaobject"><img src="../images/UseCase_tMap6-1.png"></div><p>For this Job, the metadata has been prepared for the source and connection
					components. For more information on how to set up the DB connection schema
					metadata, see the relevant section in the <span class="bluebold">Talend Open Studio</span>
					<span class="bold"><strong>User Guide</strong></span>.</p><p>This Job is formed with five components, four database components and a
					mapping component.</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Drop the DB Connection under the <span class="bold"><strong>Metadata</strong></span> node of the <span class="bold"><strong>Repository</strong></span> to the design workspace. In this example, the
							source table is called <span class="emphasis"><em>people_age</em></span>.</p></li><li class="listitem"><p>Select <span class="bold"><strong>tMysqlInput</strong></span> from the list that
							pops up when dropping the component. </p></li></ul></div><div class="mediaobject"><img src="../images/UseCase_tMap6-2.png"></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Drop the lookup DB connection table from the <span class="bold"><strong>Metadata</strong></span> node to the design workspace selecting
								<span class="bold"><strong>tMysqlInput</strong></span> from the list that pops
							up. In this Job, the lookup is called
								<span class="emphasis"><em>large_data_volume</em></span>. </p></li><li class="listitem"><p>The same way, drop the DB connection from the <span class="bold"><strong>Metadata</strong></span> node to the design workspace selecting
								<span class="bold"><strong>tMysqlConnection</strong></span> from the list that
							pops up. This component creates a permanent connection to the lookup
							database table in order not to do that every time we want to load a row
							from the lookup table.</p></li><li class="listitem"><p>Then pick the <span class="bold"><strong>tMap</strong></span> component from the
								<span class="bold"><strong>Processing</strong></span> family, and the
								<span class="bold"><strong>tMysqlOutput</strong></span> and <span class="bold"><strong>tMysqlCommit</strong></span> components from the <span class="bold"><strong>Database</strong></span> family in the <span class="bold"><strong>Palette </strong></span>to the right hand side of the editor. </p></li><li class="listitem"><p>Now connect all the components together. To do so, right-click the
								<span class="bold"><strong>tMysqlInput</strong></span> component corresponding
							to the <span class="emphasis"><em>people</em></span> table and drag the link towards
								<span class="bold"><strong>tMap</strong></span>.</p></li><li class="listitem"><p>Release the link over the <span class="bold"><strong>tMap</strong></span>
							component, the main row flow is automatically set up.</p></li><li class="listitem"><p>Rename the <span class="bold"><strong>Main</strong></span> row link to
								<span class="emphasis"><em>people</em></span>, to identify more easily the main flow
							data.</p></li><li class="listitem"><p>Perform the same operation to connect the lookup table
								(<span class="emphasis"><em>large_data_volume</em></span>) to the <span class="bold"><strong>tMap</strong></span> component and the <span class="bold"><strong>tMap</strong></span> to the <span class="bold"><strong>tMysqlOutput</strong></span> component.</p></li><li class="listitem"><p>A dialog box prompts for a name to the output link. In this example,
							the output flow is named:
							<span class="emphasis"><em>people_mixandmatch.</em></span></p></li><li class="listitem"><p>Rename also the lookup row connection link to
								<span class="emphasis"><em>large_volume,</em></span> to help identify the reference
							data flow.</p></li><li class="listitem"><p>Connect <span class="bold"><strong>tMysqlConnection</strong></span> to <span class="bold"><strong>tMysqlInput</strong></span> using the trigger link <span class="bold"><strong>OnSubjobOk</strong></span>.</p></li><li class="listitem"><p>Connect the <span class="bold"><strong>tMysqlInput</strong></span> component to
							the <span class="bold"><strong>tMysqlCommit</strong></span> component using the
							trigger link <span class="bold"><strong>OnSubjobOk</strong></span>.</p></li><li class="listitem"><p>Then double-click the <span class="bold"><strong>tMap</strong></span> component
							to open the graphical mapping editor.</p></li></ul></div><div class="mediaobject"><img src="../images/UseCase_tMap6-3.png"></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>The <span class="bold"><strong>Output</strong></span> table (that was created
							automatically when you linked the <span class="bold"><strong>tMap</strong></span>
							to the <span class="bold"><strong>tMySQLOutput</strong></span> will be formed by
							the matching rows from the lookup flow
								(<span class="emphasis"><em>large_data_volume</em></span>) and the main flow
								(<span class="emphasis"><em>people_age</em></span>).</p></li><li class="listitem"><p>Select the main flow rows that are to be passed on to the output and
							drag them over to paste them in the Output table (to the right hand side
							of the mapping editor). </p></li><li class="listitem"><p>In this example, the selection from the main flow include the
							following fields: <span class="emphasis"><em>id</em></span>,
								<span class="emphasis"><em>first_name</em></span>, <span class="emphasis"><em>last_Name</em></span> and
								<span class="emphasis"><em>age</em></span>. </p></li><li class="listitem"><p>From the lookup table, the following column is selected:
								<span class="emphasis"><em>city</em></span>. </p></li><li class="listitem"><p>Drop the selected columns from the input tables
								(<span class="emphasis"><em>people</em></span> and <span class="emphasis"><em>large_volume</em></span>)
							to the output table.</p></li><li class="listitem"><p>Now set up the join between the main and lookup flows.</p></li><li class="listitem"><p>Select the <span class="emphasis"><em>age</em></span> column of the main flow table (on
							top) and drag it towards the <span class="emphasis"><em>age</em></span> column of the
							lookup flow table (<span class="emphasis"><em>large_volume</em></span> in this
							example).</p></li><li class="listitem"><p>A key icon appears next to the linked expression on the lookup table.
							The join is now established.</p></li><li class="listitem"><p>Click the <span class="bold"><strong>tMap settings</strong></span> button, click
							the three-dot button corresponding to <span class="bold"><strong>Lookup
								Model</strong></span>, and select the <span class="bold"><strong>Reload at
								each row</strong></span> option from the <span class="bold"><strong>[Options]</strong></span> dialog box in order to reload the lookup for
							each row being processed.</p></li></ul></div><div class="mediaobject"><img src="../images/UseCase_tMap6-4.png"></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>In the same way, set <span class="bold"><strong>Match Model</strong></span> to
								<span class="bold"><strong>All matches</strong></span> in the Lookup table, in
							order to gather all instances of <span class="emphasis"><em>age</em></span> matches in the
							output flow.</p></li><li class="listitem"><p>Now implement the filtering, based on the <span class="emphasis"><em>age</em></span>
							column, in the Lookup table. The <span class="bold"><strong>GlobalMapKey</strong></span> field is automatically created when you
							selected the <span class="bold"><strong>Reload at each row</strong></span> option.
							Indeed you can use this expression to dynamically filter the reference
							data in order to load only the relevant information when joining with
							the main flow.</p></li></ul></div><p>As mentioned in the introduction of the scenario, the main flow data contains
					only people whose age is either 40 or 60. To avoid the pain of loading all
					lookup rows, including ages that are different from 40 and 60, you can use the
					main flow age as global variable to feed the lookup filtering.</p><div class="mediaobject"><img src="../images/UseCase_tMap6-5.png"></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Drop the <span class="emphasis"><em>Age</em></span> column from the main flow table to
							the <span class="bold"><strong>Expr.</strong></span> field of the lookup
							table.</p></li><li class="listitem"><p>Then in the <span class="bold"><strong>globalMap Key </strong></span>field, put
							in the variable name, using the expression. In this example, it reads:
								<code class="code">&#8220;people.Age&#8221;</code></p></li><li class="listitem"><p>Click <span class="bold"><strong>OK</strong></span> to save the mapping setting
							and go back to the design workspace.</p></li><li class="listitem"><p>To finalize the implementation of the dynamic filtering of the lookup
							flow, you need now to add a WHERE clause in the query of the database
							input.</p></li></ul></div><div class="mediaobject"><img src="../images/UseCase_tMap6-6.png"></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>At the end of the <span class="bold"><strong>Query</strong></span> field,
							following the <code class="code">Select</code> statement, type in the following WHERE
							clause: <code class="code">WHERE AGE
								='"+((Integer)globalMap.get("people.Age"))+"'"</code></p></li><li class="listitem"><p>Make sure that the type corresponds to the column used as variable. In
							this use case, <span class="emphasis"><em>Age</em></span> is of
								<span class="emphasis"><em>Integer</em></span> type. And use the variable the way you
							set in the <span class="bold"><strong>globalMap key</strong></span> field of the
							map editor.</p></li><li class="listitem"><p>Double-click the <span class="bold"><strong>tMysqloutput</strong></span>
							component to define its properties.</p></li></ul></div><div class="mediaobject"><img src="../images/UseCase_tMap6-7.png"></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Select the <span class="bold"><strong>Use an existing connection</strong></span>
							check box to leverage the created DB connection.</p></li><li class="listitem"><p>Define the target table name and relevant DB actions.</p></li><li class="listitem"><p>Click the <span class="bold"><strong>Run</strong></span> tab at the bottom of
							the design workspace, to display the Job execution tab.</p></li><li class="listitem"><p>From the <span class="bold"><strong>Debug Run</strong></span> view, click the
								<span class="bold"><strong>Traces Debug</strong></span> button to view the
							data processing progress.</p></li></ul></div><p>For more comfort, you can maximize the Job design view while executing by
					simply double-clicking on the Job name tab.</p><div class="mediaobject"><img src="../images/UseCase_tMap6-9.png"></div><p>The lookup data is reloaded for each of the main flow&#8217;s rows, corresponding to
					the age constraint. All <span class="emphasis"><em>age</em></span> matches are retrieved in the
					lookup rows and grouped together in the output flow.</p><p>Therefore if you check out the data contained in the newly created
						<span class="emphasis"><em>people_mixandmatch </em></span>table, you will find all the
						<span class="emphasis"><em>age</em></span> duplicates corresponding to different individuals
					whose age equals to 60 or 40 and the city where they have been to.</p><div class="mediaobject"><img src="../images/UseCase_tmap6-10.png"></div></div><div class="section" title="Scenario 7: Mapping with join output tables"><div class="titlepage"><div><div><h3 class="title"><a name="Raa21819"></a>Scenario 7: Mapping with join output tables</h3></div></div></div><p>The following scenario describes a Job that processes reject flows without
					separating them from the main flow. </p><div class="mediaobject"><img src="../images/UseCase_tMap7-1.png"></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>In the <span class="bold"><strong>Repository</strong></span> tree view, click
								<span class="bold"><strong>Metadata</strong></span> &gt; <span class="bold"><strong>File delimited</strong></span>. Drag and drop the
								<span class="emphasis"><em>customers</em></span> metadata onto the workspace. </p><p> The <span class="emphasis"><em>customers</em></span> metadata contains information
							about customers, such as their ID, their name or their address,
							etc.</p><p> For more information about centralizing metadata, see <span class="bluebold">Talend Open Studio</span>
							<span class="bold"><strong>User Guide</strong></span>. </p></li><li class="listitem"><p>In the dialog box that asks you to choose which component type you
							want to use, select <span class="bold"><strong>tFileInputDelimited</strong></span>
							and click <span class="bold"><strong>OK</strong></span>.</p></li><li class="listitem"><p>Drop the <span class="emphasis"><em>states</em></span> metadata onto the design
							workspace. Select the same component in the dialog box and click
								<span class="bold"><strong>OK</strong></span>. </p><p> The <span class="emphasis"><em>states</em></span> metadata contains the ID of the
							state, and its name.</p></li><li class="listitem"><p>Drop a <span class="bold"><strong>tMap</strong></span> and two <span class="bold"><strong>tLogRow</strong></span> components from the <span class="bold"><strong>Palette</strong></span> onto the design workspace.</p></li><li class="listitem"><p>Connect the <span class="emphasis"><em>customers</em></span> component to the <span class="bold"><strong>tMap</strong></span>, using a <span class="bold"><strong>Row &gt;
								Main</strong></span> connection.</p></li><li class="listitem"><p>Connect the <span class="emphasis"><em>states</em></span> component to the <span class="bold"><strong>tMap</strong></span>, using a <span class="bold"><strong>Row &gt;
								Main</strong></span> connection. This flow will automatically be defined
							as <span class="bold"><strong>Lookup</strong></span>.</p></li><li class="listitem"><p>Double-click the <span class="bold"><strong>tMap</strong></span> component to
							open the <span class="bold"><strong>Map Editor</strong></span>. </p></li><li class="listitem"><p>Drop the <span class="emphasis"><em>idState</em></span> column from the main input table
							to the <span class="emphasis"><em>idState</em></span> column of the lookup table to create
							a join.</p></li><li class="listitem"><p>Click the <span class="bold"><strong>tMap settings</strong></span> button and
							set <span class="bold"><strong>Join Model</strong></span> to <span class="bold"><strong>Inner Join</strong></span>.</p></li><li class="listitem"><p>Click the <span class="bold"><strong>Property Settings</strong></span> button at
							the top of the input area to open the <span class="bold"><strong>[Property
								Settings]</strong></span> dialog box, and clear the <span class="bold"><strong>Die on error</strong></span> check box in order to handle the execution
							errors. </p><p> The <span class="bold"><strong>ErrorReject</strong></span> table is
							automatically created. </p></li></ul></div><div class="mediaobject"><img src="../images/UseCase_tMap7-2_TOS.png"></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Select the <span class="emphasis"><em>id</em></span>, <span class="emphasis"><em>idState</em></span>,
								<span class="emphasis"><em>RegTime</em></span> and <span class="emphasis"><em>RegisterTime</em></span>
							in the input table and drag them to the <span class="bold"><strong>ErrorReject</strong></span> table.</p></li></ul></div><div class="mediaobject"><img src="../images/UseCase_tMap7-3.png"></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Click the <span class="bold"><strong>[+]</strong></span> button at the top right
							of the editor to add an output table. In the dialog box that opens,
							select <span class="bold"><strong>New output</strong></span>. In the field next to
							it, type in the name of the table, <span class="emphasis"><em>out1</em></span>. Click
								<span class="bold"><strong>OK</strong></span>.</p></li><li class="listitem"><p>Drag the following columns from the input tables to the
								<span class="emphasis"><em>out1</em></span> table: <span class="emphasis"><em>id</em></span>,
								<span class="emphasis"><em>CustomerName</em></span>, <span class="emphasis"><em>idState</em></span>, and
								<span class="emphasis"><em>LabelState</em></span>. </p></li><li class="listitem"><p>Add two columns, <span class="emphasis"><em>RegTime</em></span> and
								<span class="emphasis"><em>RegisterTime</em></span>, to the end of the
								<span class="emphasis"><em>out1</em></span> table and set their date formats:
								<code class="code">"dd/MM/yyyy HH:mm"</code> and <code class="code">"yyyy-MM-dd
								HH:mm:ss.SSS"</code> respectively.</p></li><li class="listitem"><p>Click in the <span class="bold"><strong>Expression</strong></span> field for the
								<span class="emphasis"><em>RegTime</em></span> column, and press <span class="bold"><strong>Ctrl+Space</strong></span> to display the auto-completion list. Find and
							double-click <code class="code">TalendDate.parseDate</code>. Change the pattern to
								<code class="code">("dd/MM/yyyy HH:mm",row1.RegTime)</code>.</p></li><li class="listitem"><p>Do the same thing for the <span class="emphasis"><em>RegisterTime</em></span> column,
							but change the pattern to <code class="code">("yyyy-MM-dd
								HH:mm:ss.SSS",row1.RegisterTime)</code>.</p></li></ul></div><div class="mediaobject"><img src="../images/UseCase_tMap7-4.png"></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Click the <span class="bold"><strong>[+]</strong></span> button at the top of
							the output area to add an output table. In the dialog box that opens,
							select <span class="bold"><strong>Create join table from</strong></span>, choose
								<span class="emphasis"><em>Out1</em></span>, and name it
								<span class="emphasis"><em>rejectInner</em></span>. Click <span class="bold"><strong>OK</strong></span>.</p></li><li class="listitem"><p>Click the <span class="bold"><strong>tMap settings</strong></span> button and
							set <span class="bold"><strong>Catch lookup inner join reject</strong></span> to
								<span class="bold"><strong>true</strong></span> in order to handle
							rejects.</p></li><li class="listitem"><p>Drag the <span class="emphasis"><em>id</em></span>, <span class="emphasis"><em>CustomerName</em></span>,
							and <span class="emphasis"><em>idState</em></span> columns from the input tables to the
							corresponding columns of the <span class="emphasis"><em>rejectInner</em></span>
							table.</p></li><li class="listitem"><p>Click in the <span class="bold"><strong>Expression</strong></span> field for the
								<span class="emphasis"><em>LabelState</em></span> column, and type in
								<code class="code">&#8220;UNKNOWN&#8221;</code>.</p></li><li class="listitem"><p>Click in the <span class="bold"><strong>Expression</strong></span> field for the
								<span class="emphasis"><em>RegTime</em></span> column, press <span class="bold"><strong>Ctrl+Space</strong></span>, and select <code class="code">TalendDate.parseDate</code>. Change
							the pattern to <code class="code">("dd/MM/yyyy HH:mm",row1.RegTime)</code>.</p></li><li class="listitem"><p>Click in the <span class="bold"><strong>Expression</strong></span> field for the
								<span class="emphasis"><em>RegisterTime</em></span> column, press <span class="bold"><strong>Ctrl+Space</strong></span>, and select <code class="code">TalendDate.parseDate</code>, but change the pattern to
								<code class="code">("yyyy-MM-dd HH:mm:ss.SSS",row1.RegisterTime)</code>.</p><p> </p><p> If the data from <span class="emphasis"><em>row1</em></span> has a wrong pattern, it
							will be returned by the ErrorReject flow.</p></li></ul></div><div class="mediaobject"><img src="../images/UseCase_tMap7-4.png"></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Click <span class="bold"><strong>OK</strong></span> to validate the changes and
							close the editor. </p></li><li class="listitem"><p>Double-click the first <span class="bold"><strong>tLogRow</strong></span>
							component to display its <span class="bold"><strong>Component</strong></span>
							view.</p></li><li class="listitem"><p> Click <span class="bold"><strong>Sync columns</strong></span> to retrieve the
							schema structure from the mapper if needed.</p></li><li class="listitem"><p>In the <span class="bold"><strong>Mode</strong></span> area, select <span class="bold"><strong>Table.</strong></span>
						</p></li><li class="listitem"><p>Do the same thing with the second <span class="bold"><strong>tLogRow</strong></span>.</p></li><li class="listitem"><p>Save your Job and press <span class="bold"><strong>F6</strong></span> to execute
							it. </p><p> The <span class="bold"><strong>Run</strong></span> console displays the main
							out flow and the ErrorReject flow. The main output flow unites both
							valid data and inner join rejects, while the ErrorReject flow contains
							the error information about rows with unparseable date formats.</p></li></ul></div><div class="mediaobject"><img src="../images/UseCase_tMap7-5.png"></div></div></div></body></html>