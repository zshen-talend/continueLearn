<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>tMicrosoftCRMInput</title><meta name="generator" content="DocBook XSL-NS Stylesheets V1.76.1"><link rel="home" href="index.html" title="Talend Open Studio"><link rel="up" href="ch01.html" title="Chapter&nbsp;1.&nbsp;Business components"><link rel="prev" href="tMarketoOutput.html" title="tMarketoOutput"><link rel="next" href="tMicrosoftCRMOutput.html" title="tMicrosoftCRMOutput"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div lang="EN" class="section" title="tMicrosoftCRMInput"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="tMicrosoftCRMInput"></a>tMicrosoftCRMInput</h2></div></div></div><div class="mediaobject"><img src="../images/tMicrosoftCrmInput_icon32_white.png"></div><div class="section" title="tMicrosoftCRMInput Properties"><div class="titlepage"><div><div><h3 class="title"><a name="d0e5820"></a>tMicrosoftCRMInput Properties</h3></div></div></div><div class="informaltable"><table border="1"><colgroup><col class="c1"><col class="c2"><col class="c3"></colgroup><tbody><tr><td valign="top">
									<p>
										<span class="bold"><strong>Component family</strong></span>
									</p>
								</td><td valign="top">
									<p>Business </p>
								</td><td valign="top">&nbsp;</td></tr><tr><td valign="top">
									<p>
										<span class="bold"><strong>Function</strong></span>
									</p>
								</td><td colspan="2" valign="top">
									<p>Connects to an entity of Microsoft CRM database via the
										relevant webservice.</p>
								</td></tr><tr><td valign="top">
									<p>
										<span class="bold"><strong>Purpose</strong></span>
									</p>
								</td><td colspan="2" valign="top">
									<p>Allows to extract data from a MicrosoftCRM DB based on
										conditions set on specific columns.</p>
								</td></tr><tr><td valign="top">
									<p>
										<span class="bold"><strong>Basic settings</strong></span>
									</p>
								</td><td valign="top">
									<p>
										<span class="emphasis"><em>Property type</em></span>
									</p>
								</td><td valign="top">
									<p>Either <span class="bold"><strong>Built-in</strong></span> or
											<span class="bold"><strong>Repository</strong></span>:</p>
								</td></tr><tr><td>
									<p>&nbsp;</p>
								</td><td>
									<p>&nbsp;</p>
								</td><td valign="top">
									<p><span class="bold"><strong>Built-in</strong></span>: No property
										data stored centrally.</p>
								</td></tr><tr><td>
									<p>&nbsp;</p>
								</td><td>
									<p>&nbsp;</p>
								</td><td valign="top">
									<p><span class="bold"><strong>Repository</strong></span>: Select the
										Repository file where properties are stored. The fields that
										come after are pre-filled in using the fetched data.</p>
								</td></tr><tr><td>
									<p>&nbsp;</p>
								</td><td valign="top">
									<p>
										<span class="emphasis"><em>Microsoft Webservice URL</em></span>
									</p>
								</td><td valign="top">
									<p>Type in the webservice URL to connect to the MicrosoftCRM
										DB.</p>
								</td></tr><tr><td>
									<p>&nbsp;</p>
								</td><td valign="top">
									<p>
										<span class="emphasis"><em>Organizename</em></span>
									</p>
								</td><td valign="top">
									<p>Enter the name of the user or organization, set by an
										administrator, that needs to access the MicrosoftCRM
										database.</p>
								</td></tr><tr><td>
									<p>&nbsp;</p>
								</td><td valign="top">
									<p><span class="emphasis"><em>Username</em></span> and
											<span class="emphasis"><em>Password</em></span></p>
								</td><td valign="top">
									<p>Type in the Webservice user authentication data.</p>
								</td></tr><tr><td>
									<p>&nbsp;</p>
								</td><td valign="top">
									<p>
										<span class="emphasis"><em>Domain</em></span>
									</p>
								</td><td valign="top">
									<p>Type in the domain name of the server on which
										MicrosoftCRM is hosted.</p>
								</td></tr><tr><td>
									<p>&nbsp;</p>
								</td><td valign="top">
									<p>
										<span class="emphasis"><em>Host</em></span>
									</p>
								</td><td valign="top">
									<p>Type in the IP address of Microsoft CRM database
										server.</p>
								</td></tr><tr><td>
									<p>&nbsp;</p>
								</td><td valign="top">
									<p>
										<span class="emphasis"><em>Port</em></span>
									</p>
								</td><td valign="top">
									<p>Listening port number of Microsoft CRM database
										server.</p>
								</td></tr><tr><td>
									<p>&nbsp;</p>
								</td><td valign="top">
									<p>
										<span class="emphasis"><em>Time out (seconds)</em></span>
									</p>
								</td><td valign="top">
									<p>Number of seconds for the port to listen before
										closing.</p>
								</td></tr><tr><td>
									<p>&nbsp;</p>
								</td><td valign="top">
									<p>
										<span class="emphasis"><em>Entity</em></span>
									</p>
								</td><td valign="top">
									<p>Select the relevant entity in the list.</p>
								</td></tr><tr><td>
									<p>&nbsp;</p>
								</td><td valign="top">
									<p><span class="emphasis"><em>Schema</em></span> and <span class="emphasis"><em>Edit
											Schema</em></span></p>
								</td><td valign="top">
									<p>A schema is a row description, i.e., it defines the number
										of fields that will be processed and passed on to the next
										component. The schema is either built-in or remote in the
										Repository. </p>
									<p> Click <span class="bold"><strong>Edit Schema</strong></span> to
										make changes to the schema.</p>
									<div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="16pt"><img alt="[Note]" src="../images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>if you make changes, the schema automatically becomes
											built-in.</p></td></tr></table></div>
									<div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="16pt"><img alt="[Note]" src="../images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>In this component the schema is related to the
											selected entity.</p></td></tr></table></div>
								</td></tr><tr><td>
									<p>&nbsp;</p>
								</td><td valign="top">
									<p>
										<span class="emphasis"><em>Logical operators used to combine
											conditions</em></span>
									</p>
								</td><td valign="top">
									<p>In the case you want to combine the conditions you set on
										columns, select the combine mode you want to use.</p>
								</td></tr><tr><td>
									<p>&nbsp;</p>
								</td><td valign="top">
									<p>
										<span class="emphasis"><em>Conditions</em></span>
									</p>
								</td><td valign="top">
									<p>Click the plus button to add as many conditions as
										needed.</p>
									<p>The conditions are performed one after the other for each
										row.</p>
									<p>
										<span class="bold"><strong>Input column</strong></span>: Click in the
										cell and select the column of the input schema the condition
										is to be set on.</p>
									<p>
										<span class="bold"><strong>Operator</strong></span>: Click in the cell
										and select the operator to bind the input column with the
										value.</p>
									<p>
										<span class="bold"><strong>Value</strong></span>: Type in the column
										value, between quotes if need be.</p>
								</td></tr><tr><td valign="top">
									<p>
										<span class="bold"><strong>Advanced settings</strong></span>
									</p>
								</td><td valign="top">
									<p>
										<span class="emphasis"><em>tStatCatcher Statistics</em></span>
									</p>
								</td><td valign="top">
									<p>Select this check box to gather the Job processing
										metadata at a Job level as well as at each component
										level.</p>
								</td></tr><tr><td valign="top">
									<p>
										<span class="bold"><strong>Usage</strong></span>
									</p>
								</td><td colspan="2" valign="top">
									<p>Usually used as a Start component. An output component is
										required. </p>
								</td></tr><tr><td valign="top">
									<p>
										<span class="bold"><strong>Limitation</strong></span>
									</p>
								</td><td colspan="2" valign="top">
									<p>n/a</p>
								</td></tr></tbody></table></div></div><div class="section" title="Scenario: Writing data in a Microsoft CRM database and putting conditions on columns to extract specified rows"><div class="titlepage"><div><div><h3 class="title"><a name="Raa70068"></a>Scenario: Writing data in a Microsoft CRM database and putting conditions on
					columns to extract specified rows</h3></div></div></div><p>This scenario describes a four-component Job which aims at writing the data
					included in a delimited input file in a custom entity in a MicrosoftCRM
					database. It then extracts specified rows to an output file using the conditions
					set on certain input columns.</p><div class="warning" title="Warning" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Warning"><tr><td rowspan="2" align="center" valign="top" width="16pt"><img alt="[Warning]" src="../images/warning.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>
						<span class="emphasis"><em>If you want to write in a CustomEntity in Microsoft CRM database,
							make sure to name the columns in accordance with the naming rule set by
							Microsoft, that is "name_columnname" all in lower case.</em></span>
					</p></td></tr></table></div><div class="section" title="Setting up the Job"><div class="titlepage"><div><div><h4 class="title"><a name="d0e6243"></a>Setting up the Job</h4></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Drop the following components from the <span class="bold"><strong>Palette</strong></span> to the design workspace: <span class="bold"><strong>tFileInputdelimited</strong></span>, <span class="bold"><strong>tFileOutputDelimited</strong></span>, <span class="bold"><strong>tMicrosoftCRMInput</strong></span>, and <span class="bold"><strong>tMicrosoftCRMOutput</strong></span>.</p><div class="mediaobject"><img src="../images/Use_Case_tMicrosoftCRM.png"></div></li><li class="step" title="Step 2"><p>Connect <span class="bold"><strong>tFileInputDelimited</strong></span> to
									<span class="bold"><strong>tMicrosoftCRMOutput</strong></span> using a
									<span class="bold"><strong>Row Main</strong></span> connection.</p></li><li class="step" title="Step 3"><p>Connect <span class="bold"><strong>tMicrosoftCRMIntput</strong></span> to
									<span class="bold"><strong>tFileOutputDelimited</strong></span> using a
									<span class="bold"><strong>Row Main</strong></span> connection.</p></li><li class="step" title="Step 4"><p>Connect <span class="bold"><strong>tFileInputDelimited</strong></span> to
									<span class="bold"><strong>tMicrosoftCRMInput</strong></span> using
									<span class="bold"><strong>OnSubjobOk</strong></span> connection.</p></li></ol></div></div><div class="section" title="Configuring tFileInputDelimited"><div class="titlepage"><div><div><h4 class="title"><a name="d0e6304"></a>Configuring tFileInputDelimited</h4></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Double-click <span class="bold"><strong>tFileInputDelimited</strong></span>
								to display its <span class="bold"><strong>Basic settings</strong></span> view
								and define its properties</p><div class="mediaobject"><img src="../images/Use_Case_tMicrosoftCRM1.png"></div></li><li class="step" title="Step 2"><p>Set the <span class="bold"><strong>Property Type</strong></span> to
									<span class="bold"><strong>Repository</strong></span> if you have stored
								the input file properties centrally in the <span class="bold"><strong>Metadata</strong></span> node in the <span class="bold"><strong>Repository</strong></span> tree view. Otherwise, select <span class="bold"><strong>Built-In</strong></span> and fill the fields that follow
								manually. In this example, property is set to <span class="bold"><strong>Built-In</strong></span>.</p></li><li class="step" title="Step 3"><p>Click the three-dot button next to the <span class="bold"><strong>File
									Name/Input Stream</strong></span> field and browse to the delimited
								file that holds the input data. The input file in this example
								contains the following columns: <span class="emphasis"><em>new_id</em></span>,
									<span class="emphasis"><em>new_status</em></span>,
									<span class="emphasis"><em>new_firstname</em></span>,
									<span class="emphasis"><em>new_email</em></span>, <span class="emphasis"><em>new_city</em></span>,
									<span class="emphasis"><em>new_initial</em></span> and
									<span class="emphasis"><em>new_zipcode</em></span>.</p><div class="mediaobject"><img src="../images/Use_Case_tMicrosoftCRM2.png"></div></li><li class="step" title="Step 4"><p>In the <span class="bold"><strong>Basic settings</strong></span> view,
								define the <span class="bold"><strong>Row Separator</strong></span> allowing
								to identify the end of a row. Then define the <span class="bold"><strong>Field Separator</strong></span> used to delimit fields in a
								row.</p></li><li class="step" title="Step 5"><p>If needed, define the header, footer and limit number of processed
								rows in the corresponding fields. In this example, the header,
								footer and limits are not set.</p></li><li class="step" title="Step 6"><p>Click <span class="bold"><strong>Edit schema</strong></span> to open a
								dialog box where you can define the input schema you want to write
								in Microsoft CRM database.</p><div class="mediaobject"><img src="../images/Use_Case_tMicrosoftCRM3.png"></div></li><li class="step" title="Step 7"><p>Click <span class="bold"><strong>OK</strong></span> to close the dialog
								box.</p></li></ol></div></div><div class="section" title="Configuring tMicrosoftCRMOutput"><div class="titlepage"><div><div><h4 class="title"><a name="d0e6401"></a>Configuring tMicrosoftCRMOutput</h4></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Double-click <span class="bold"><strong>tMicrosoftCRMOutput</strong></span>
								to display the component <span class="bold"><strong>Basic
									settings</strong></span> view and define its properties.</p><div class="mediaobject"><img src="../images/Use_Case_tMicrosoftCRM4.png"></div></li><li class="step" title="Step 2"><p>Enter the Microsoft Web Service URL as well as the user name and
								password in the corresponding fields.</p></li><li class="step" title="Step 3"><p>In the <span class="bold"><strong>OrganizeName</strong></span> field, enter
								the name that is given the right to access the Microsoft CRM
								database.</p></li><li class="step" title="Step 4"><p>In the <span class="bold"><strong>Domain field</strong></span>, enter the
								domain name of the server on which Microsoft CRM is hosted, and then
								enter the host IP address and the listening port number in the
								corresponding fields.</p></li><li class="step" title="Step 5"><p>In the <span class="bold"><strong>Action</strong></span> list, select the
								operation you want to carry on. In this example, we want to insert
								data in a custom entity in Microsoft CRM.</p></li><li class="step" title="Step 6"><p>In the <span class="bold"><strong>Time out</strong></span> field, set the
								amount of time (in seconds) after which the Job will time
								out.</p></li><li class="step" title="Step 7"><p>In the <span class="bold"><strong>Entity </strong></span>list, select one
								among those offered. In this example,
									<span class="emphasis"><em>CustomEntity</em></span> is selected.</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="16pt"><img alt="[Note]" src="../images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>If <span class="emphasis"><em>CustomEntity</em></span> is selected, a <span class="bold"><strong>Custom Entity Name</strong></span> field displays
									where you need to enter a name for the custom entity.</p></td></tr></table></div><p>The <span class="bold"><strong>Schema</strong></span> is then automatically
								set according to the entity selected. If needed, click <span class="bold"><strong>Edit schema</strong></span> to display a dialog box where
								you can modify this schema and remove the columns that you do not
								need in the output. </p></li><li class="step" title="Step 8"><p>Click <span class="bold"><strong>Sync columns</strong></span> to retrieve
								the schema from the preceding component.</p><div class="mediaobject"><img src="../images/Use_Case_tMicrosoftCRM5.png"></div></li></ol></div></div><div class="section" title="Configuring tMicrosoftCRMInput"><div class="titlepage"><div><div><h4 class="title"><a name="d0e6479"></a>Configuring tMicrosoftCRMInput</h4></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Double-click <span class="bold"><strong>tMicrosoftCRMInput</strong></span>
								to display the component <span class="bold"><strong>Basic
									settings</strong></span> view and define its properties.</p><div class="mediaobject"><img src="../images/Use_Case_tMicrosoftCRM6.png"></div></li><li class="step" title="Step 2"><p>Set the <span class="bold"><strong>Property Type</strong></span> to
									<span class="bold"><strong>Repository</strong></span> if you have stored
								the input file properties centrally in the <span class="bold"><strong>Metadata</strong></span> node in the <span class="bold"><strong>Repository</strong></span> tree view. Otherwise, select <span class="bold"><strong>Built-In</strong></span> and fill the fields that follow
								manually. In this example, property is set to <span class="bold"><strong>Built-In</strong></span>.</p></li><li class="step" title="Step 3"><p>Enter the Microsoft Web Service URL as well as the user name and
								password in the corresponding fields and enter the name that is
								given the right to access the Microsoft CRM database in the
									<span class="bold"><strong>OrganizeName</strong></span> field.</p></li><li class="step" title="Step 4"><p>In the <span class="bold"><strong>Domain field</strong></span>, enter the
								domain name of the server on which Microsoft CRM is hosted, and then
								enter the host IP address and the listening port number in the
								corresponding fields.</p></li><li class="step" title="Step 5"><p>In the <span class="bold"><strong>Time out</strong></span> field, set the
								amount of time (in seconds) after which the Job will time
								out.</p></li><li class="step" title="Step 6"><p>In the <span class="bold"><strong>Entity </strong></span>list, select the
								one among those offered you want to connect to. In this example,
									<span class="emphasis"><em>CustomEntity</em></span> is selected.</p></li><li class="step" title="Step 7"><p>The <span class="bold"><strong>Schema</strong></span> is then automatically
								set according to the entity selected. But you can modify it
								according to your needs. In this example, you should set the schema
								manually since you want to access a custom entity. Copy the
								seven-column schema from <span class="bold"><strong>tMicrosoftCRMOutput</strong></span> and paste it in the schema
								dialog box in <span class="bold"><strong>tMicrosoftCRMInput</strong></span>.</p><div class="mediaobject"><img src="../images/Use_Case_tMicrosoftCRM7.png"></div></li><li class="step" title="Step 8"><p>Click <span class="bold"><strong>OK</strong></span> to close the dialog box.
								You will be prompted to propagate changes. Click <span class="bold"><strong>Yes</strong></span> in the popup message.</p></li><li class="step" title="Step 9"><p>In the <span class="bold"><strong>Basic settings</strong></span> view,
								select <span class="bold"><strong>And</strong></span> or <span class="bold"><strong>Or</strong></span> as the logical operator you want to use to
								combine the conditions you set on the input columns. In this
								example, we want to set two conditions on two different input
								columns and we use <span class="bold"><strong>And</strong></span> as the
								logical operator.</p></li><li class="step" title="Step 10"><p>In the <span class="bold"><strong>Condition</strong></span> area, click the
								plus button to add as many lines as needed and then click in each
								line in the <span class="bold"><strong>Input column</strong></span> list and
								select the column you want to set condition on. In this example, we
								want to set conditions on two columns, <span class="emphasis"><em>new-city</em></span>
								and <span class="emphasis"><em>new_id</em></span>. We want to extract all customer
								rows whose city is equal to &#8220;New York&#8221; and whose id is greater than
								2.</p></li><li class="step" title="Step 11"><p>Click in each line in the <span class="bold"><strong>Operator</strong></span> list and select the operator to bind the
								input column with its value, in this example <span class="bold"><strong>Equal </strong></span>is selected for <span class="emphasis"><em>new_city</em></span>
								and <span class="bold"><strong>Greater Than</strong></span> for
									<span class="emphasis"><em>new_id</em></span>.</p></li><li class="step" title="Step 12"><p>Click in each line in the <span class="bold"><strong>Value</strong></span>
								list and set the column value, <code class="code">New York</code> for
									<span class="emphasis"><em>new_city</em></span> and <code class="code">2</code> for
									<span class="emphasis"><em>new_id</em></span> in this example. You can use a fixed
								or a context value in this field.</p></li></ol></div></div><div class="section" title="Configuring tFileOutputDelimited"><div class="titlepage"><div><div><h4 class="title"><a name="d0e6633"></a>Configuring tFileOutputDelimited</h4></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Double-click <span class="bold"><strong>tFileOutputdelimited</strong></span>
								to display the component <span class="bold"><strong>Basic
									settings</strong></span> view and define its properties.</p><div class="mediaobject"><img src="../images/Use_Case_tMicrosoftCRM8.png"></div></li><li class="step" title="Step 2"><p>Set <span class="bold"><strong>Property Type</strong></span> to <span class="bold"><strong>Built-In</strong></span> and then click the three-dot
								button next to the <span class="bold"><strong>File Name</strong></span> field
								and browse to the output file.</p></li><li class="step" title="Step 3"><p>Set row and field separators in the corresponding fields.</p></li><li class="step" title="Step 4"><p> Select the <span class="bold"><strong>Append</strong></span> check box if
								you want to add the new rows at the end of the records.</p></li><li class="step" title="Step 5"><p>Select the <span class="bold"><strong>Include Header</strong></span> check
								box if the output file includes a header.</p></li><li class="step" title="Step 6"><p>Click <span class="bold"><strong>Sync columns</strong></span> to retrieve
								the schema from the preceding component.</p></li></ol></div></div><div class="section" title="Job execution"><div class="titlepage"><div><div><h4 class="title"><a name="d0e6682"></a>Job execution</h4></div></div></div><p>Save the Job and press <span class="bold"><strong>F6</strong></span> to execute
						it.</p><div class="mediaobject"><img src="../images/Use_Case_tMicrosoftCRM9.png"></div><p>Only customers who live in New York city and those whose &#8220;id&#8221; is greater
						than 2 are listed in the output file you stored locally.</p></div></div></div></body></html>