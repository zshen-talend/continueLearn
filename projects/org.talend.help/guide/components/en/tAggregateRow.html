<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>tAggregateRow</title><meta name="generator" content="DocBook XSL-NS Stylesheets V1.76.1"><link rel="home" href="index.html" title="Talend Enterprise"><link rel="up" href="ch16.html" title="Chapter&nbsp;16.&nbsp;Processing components"><link rel="prev" href="ch16.html" title="Chapter&nbsp;16.&nbsp;Processing components"><link rel="next" href="tAggregateSortedRow.html" title="tAggregateSortedRow"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div lang="EN" class="section" title="tAggregateRow"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="tAggregateRow"></a>tAggregateRow</h2></div></div></div><div class="mediaobject"><img src="../images/tAggregateRow.png"></div><div class="section" title="tAggregateRow properties"><div class="titlepage"><div><div><h3 class="title"><a name="d0e297803"></a>tAggregateRow properties</h3></div></div></div><div class="informaltable"><table border="1"><colgroup><col class="c1"><col class="c2"><col class="c3"></colgroup><tbody><tr><td valign="top">
									<p>
										<span class="bold"><strong>Component family</strong></span>
									</p>
								</td><td valign="top">
									<p>Processing</p>
								</td><td valign="top">&nbsp;</td></tr><tr><td valign="top">
									<p>
										<span class="bold"><strong>Function</strong></span>
									</p>
								</td><td colspan="2" valign="top">
									<p><span class="bold"><strong>tAggregateRow</strong></span> receives a
										flow and aggregates it based on one or more columns. For
										each output line, are provided the aggregation key and the
										relevant result of set operations (min, max, sum...).</p>
								</td></tr><tr><td valign="top">
									<p>
										<span class="bold"><strong>Purpose</strong></span>
									</p>
								</td><td colspan="2" valign="top">
									<p>Helps to provide a set of metrics based on values or
										calculations. </p>
								</td></tr><tr><td valign="top">
									<p>
										<span class="bold"><strong>Basic settings</strong></span>
									</p>
								</td><td valign="top">
									<p><span class="emphasis"><em>Schema</em></span> and <span class="emphasis"><em>Edit
											Schema</em></span></p>
								</td><td valign="top">
									<p>A schema is a row description, i.e., it defines the number
										of fields that will be processed and passed on to the next
										component. The schema is either built-in or remote in the
										Repository. </p>
									<p> Click <span class="bold"><strong>Edit Schema</strong></span> to
										make changes to the schema. Note that if you make changes,
										the schema automatically becomes built-in.</p>
								</td></tr><tr><td>
									<p>&nbsp;</p>
								</td><td>
									<p>&nbsp;</p>
								</td><td valign="top">
									<p><span class="bold"><strong>Built-in</strong></span>: The schema will
										be created and stored locally for this component only.
										Related topic: see <span class="bluebold">Talend Enterprise Studio</span>
										<span class="bold"><strong>User Guide</strong></span>.</p>
								</td></tr><tr><td>
									<p>&nbsp;</p>
								</td><td>
									<p>&nbsp;</p>
								</td><td valign="top">
									<p><span class="bold"><strong>Repository</strong></span>: The schema
										already exists and is stored in the Repository, hence can be
										reused in various projects and Job flowcharts. Related
										topic: see <span class="bluebold">Talend Enterprise Studio</span>
										<span class="bold"><strong>User Guide</strong></span>.</p>
								</td></tr><tr><td>
									<p>&nbsp;</p>
								</td><td valign="top">
									<p>
										<span class="emphasis"><em>Group by</em></span>
									</p>
								</td><td valign="top">
									<p>Define the aggregation sets, the values of which will be
										used for calculations.</p>
								</td></tr><tr><td>
									<p>&nbsp;</p>
								</td><td>
									<p>&nbsp;</p>
								</td><td valign="top">
									<p><span class="bold"><strong>Output Column</strong></span>: Select the
										column label in the list offered based on the schema
										structure you defined. You can add as many output columns as
										you wish to make more precise aggregations. </p>
									<p> Ex: Select Country to calculate an average of values for
										each country of a list or select Country and Region if you
										want to compare one country&#8217;s regions with another country&#8217;
										regions.</p>
								</td></tr><tr><td>
									<p>&nbsp;</p>
								</td><td>
									<p>&nbsp;</p>
								</td><td valign="top">
									<p><span class="bold"><strong>Input Column</strong></span>: Match the
										input column label with your output columns, in case the
										output label of the aggregation set needs to be
										different.</p>
								</td></tr><tr><td>
									<p>&nbsp;</p>
								</td><td valign="top">
									<p>
										<span class="emphasis"><em>Operations</em></span>
									</p>
								</td><td valign="top">
									<p>Select the type of operation along with the value to use
										for the calculation and the output field.</p>
								</td></tr><tr><td>
									<p>&nbsp;</p>
								</td><td>
									<p>&nbsp;</p>
								</td><td valign="top">
									<p><span class="bold"><strong>Output Column</strong></span>: Select the
										destination field in the list.</p>
								</td></tr><tr><td>
									<p>&nbsp;</p>
								</td><td>
									<p>&nbsp;</p>
								</td><td valign="top">
									<p><span class="bold"><strong>Function</strong></span>: Select the
										operator among: count, min, max, avg, sum, first, last,
										list, list(objects), count(distinct), standard
										deviation.</p>
								</td></tr><tr><td>
									<p>&nbsp;</p>
								</td><td>
									<p>&nbsp;</p>
								</td><td valign="top">
									<p><span class="bold"><strong>Input column</strong></span>: Select the
										input column from which the values are taken to be
										aggregated.</p>
								</td></tr><tr><td>
									<p>&nbsp;</p>
								</td><td>
									<p>&nbsp;</p>
								</td><td valign="top">
									<p><span class="bold"><strong>Ignore null values</strong></span>:
										Select the check boxes corresponding to the names of the
										columns for which you want the NULL value to be
										ignored.</p>
								</td></tr><tr><td valign="top">
									<p>
										<span class="bold"><strong>Advanced settings</strong></span>
									</p>
								</td><td valign="top">
									<p>
										<span class="emphasis"><em>Delimiter(only for list operation)</em></span>
									</p>
								</td><td valign="top">
									<p>Enter the delimiter you want to use to separate the
										different operations.</p>
								</td></tr><tr><td>
									<p>&nbsp;</p>
								</td><td valign="top">
									<p>
										<span class="emphasis"><em>Use financial precision, this is the max precision
											for &#8220;sum&#8221; and &#8220;avg&#8221; operations, checked option heaps
											more memory and slower than unchecked.</em></span>
									</p>
								</td><td valign="top">
									<p>Select this check box to use a financial precision. This
										is a max precision but consumes more memory and slows the
										processing.</p>
									<div class="warning" title="Warning" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Warning"><tr><td rowspan="2" align="center" valign="top" width="16pt"><img alt="[Warning]" src="../images/warning.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>
											<span class="emphasis"><em>We advise you to use the BigDecimal type for
												the output in order to obtain precise results.
											</em></span>
										</p></td></tr></table></div>
								</td></tr><tr><td>
									<p>&nbsp;</p>
								</td><td valign="top">
									<p>
										<span class="emphasis"><em>Check type overflow (slower)</em></span>
									</p>
								</td><td valign="top">
									<p>Checks the type of data to ensure that the Job doesn&#8217;t
										crash.</p>
								</td></tr><tr><td>
									<p>&nbsp;</p>
								</td><td valign="top">
									<p>
										<span class="emphasis"><em>Check ULP (Unit in the Last Place), ensure that a
											value will be incremented or decremented correctly, only
											float and double types. (slower) </em></span>
									</p>
								</td><td valign="top">
									<p>Select this check box to ensure the most precise results
										possible for the Float and Double types.</p>
								</td></tr><tr><td>
									<p>&nbsp;</p>
								</td><td valign="top">
									<p>
										<span class="emphasis"><em>tStatCatcher Statistics</em></span>
									</p>
								</td><td valign="top">
									<p>Check this box to collect the log data at component
										level.</p>
								</td></tr><tr><td valign="top">
									<p>
										<span class="bold"><strong>Usage</strong></span>
									</p>
								</td><td colspan="2" valign="top">
									<p>This component handles flow of data therefore it requires
										input and output, hence is defined as an intermediary step.
										Usually the use of <span class="bold"><strong>tAggregateRow</strong></span> is combined with the <span class="bold"><strong>tSortRow</strong></span> component</p>
								</td></tr><tr><td valign="top">
									<p>
										<span class="bold"><strong>Limitation</strong></span>
									</p>
								</td><td colspan="2" valign="top">
									<p>n/a</p>
								</td></tr></tbody></table></div></div><div class="section" title="Scenario 1: Aggregating values and sorting data"><div class="titlepage"><div><div><h3 class="title"><a name="Raa44816"></a>Scenario<span> 1</span>: Aggregating values and sorting data</h3></div></div></div><p>The following scenario describes a four-component Job. As input component, a
					CSV file contains countries and notation values to be sorted by best average
					value. This component is connected to a <span class="bold"><strong>tAggregateRow</strong></span> operator, in charge of the average calculation
					then to a <span class="bold"><strong>tSortRow</strong></span> component for the ascending
					sort. The output flow goes to the new csv file. </p><div class="mediaobject"><img src="../images/Use_Case_tAggregateRow1.png"></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>From the <span class="bold"><strong>File</strong></span> folder in the <span class="bold"><strong>Palette</strong></span>, drop a <span class="bold"><strong>tFileInputDelimited</strong></span> component to the design workspace.
						</p></li><li class="listitem"><p>Click the label and rename it as <span class="emphasis"><em>Countries</em></span>. Or
							rename it from the <span class="bold"><strong>View</strong></span> tab
							panel</p></li><li class="listitem"><p>In the <span class="bold"><strong>Basic settings</strong></span> tab panel of
							this component, define the filepath and the delimitation criteria. Or
							select the metadata file in the repository if it exists.</p></li><li class="listitem"><p>Click <span class="bold"><strong>Edit schema...</strong></span> and set the
							columns: <span class="emphasis"><em>Countries</em></span> and <span class="emphasis"><em>Points</em></span>
							to match the file structure. If your file description is stored in the
							Metadata area of the Repository, the schema is automatically uploaded
							when you click <span class="bold"><strong>Repository</strong></span> in <span class="bold"><strong>Schema type</strong></span> field.</p></li><li class="listitem"><p>Then from the <span class="bold"><strong>Processing</strong></span> folder in
							the <span class="bold"><strong>Palette</strong></span>, drop a <span class="bold"><strong>tAggregateRow</strong></span> component to the design
							workspace. Rename it as <span class="emphasis"><em>Calculation</em></span>.</p></li><li class="listitem"><p>Connect <span class="emphasis"><em>Countries</em></span> to
								<span class="emphasis"><em>Calculation</em></span> via a right-click and select
								<span class="bold"><strong>Row &gt; Main</strong></span>.</p></li><li class="listitem"><p>Double-click <span class="emphasis"><em>Calculation</em></span> (<span class="bold"><strong>tAggregateRow </strong></span>component) to set the properties. Click
								<span class="bold"><strong>Edit schema</strong></span> and define the output
							schema. You can add as many columns as you need to hold the set
							operations results in the output flow.</p></li></ul></div><div class="mediaobject"><img src="../images/Use_Case_tAggregateRow3.png"></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>In this example, we&#8217;ll calculate the average notation value per
							country and we will display the max and the min notation for each
							country, given that each country holds several notations. Click
								<span class="bold"><strong>OK</strong></span> when the schema is
							complete.</p></li><li class="listitem"><p>To carry out the various set operations, back in the <span class="bold"><strong>Basic settings</strong></span> panel, define the sets holding
							the operations in the <span class="bold"><strong>Group By </strong></span>area. In
							this example, select <span class="bold"><strong>Country</strong></span> as group
							by column. Note that the output column needs to be defined a key field
							in the schema. The first column mentioned as output column in the
								<span class="bold"><strong>Group By</strong></span> table is the main set of
							calculation. All other output sets will be secondary by order of
							display. </p></li><li class="listitem"><p>Select the input column which the values will be taken from.</p></li><li class="listitem"><p>Then fill in the various operations to be carried out. The functions
							are <span class="emphasis"><em>average</em></span>, <span class="emphasis"><em>min</em></span>,
								<span class="emphasis"><em>max</em></span> for this use case. Select the input
							columns, where the values are taken from and select the check boxes in
							the <span class="bold"><strong>Ignore null values</strong></span> list as
							needed.</p></li></ul></div><div class="mediaobject"><img src="../images/Use_Case_tAggregateRow4.png"></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Drop a <span class="bold"><strong>tSortRow</strong></span> component from the
								<span class="bold"><strong>Palette</strong></span> onto the design workspace.
							For more information regarding this component, see <a class="xref" href="tSortRow.html#Raa63352" title="tSortRow properties">the section called &#8220;tSortRow properties&#8221;</a>.</p></li><li class="listitem"><p>Connect the <span class="bold"><strong>tAggregateRow</strong></span> to this new
							component using a row main link. </p></li><li class="listitem"><p>On the <span class="bold"><strong>Component</strong></span> view of the
								<span class="bold"><strong>tSortRow</strong></span> component, define the
							column the sorting is based on, the sorting type and order. </p></li></ul></div><div class="mediaobject"><img src="../images/Use_Case_tAggregateRow5.png"></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>In this case, the column to be sorted by is
								<span class="emphasis"><em>Country</em></span>, the sort type is alphabetical and the
							order is ascending.</p></li><li class="listitem"><p>Drop a <span class="bold"><strong>tFileOutputDelimited</strong></span> from the
								<span class="bold"><strong>Palette</strong></span> to the design workspace and
							define it to set the output flow.</p></li><li class="listitem"><p>Connect the <span class="bold"><strong>tSortRow</strong></span> component to
							this output component.</p></li><li class="listitem"><p>In the <span class="bold"><strong>Component</strong></span> view, enter the
							output filepath. Edit the schema if need be. In this case the delimited
							file is of csv type. And select the <span class="bold"><strong>Include
								Header</strong></span> check box to reuse the schema column labels in
							your output flow.</p></li><li class="listitem"><p>Press <span class="bold"><strong>F6</strong></span> to execute the Job. The csv
							file thus created contains the aggregating result. </p></li></ul></div><div class="mediaobject"><img src="../images/Use_Case_tAggregateRow6.png"></div></div><div class="section" title="Scenario 2: Aggregating values based on dynamic schema"><div class="titlepage"><div><div><h3 class="title"><a name="d0e298442"></a>Scenario 2: Aggregating values based on dynamic schema</h3></div></div></div><p>In this scenario, a four-component Java Job uses a <span class="bold"><strong>tAggregateRow</strong></span> component to read data from a CSV file, group the
					data, and then send the grouping result to the <span class="bold"><strong>Run</strong></span> console and an output file. A dynamic schema is used in this
					Job. For more information about dynamic schema, see <span class="bluebold">Talend Enterprise Studio</span>
					<span class="bold"><strong>User Guide</strong></span>.</p><div class="mediaobject"><img src="../images/Use_Case_tAggregateRow7.png"></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Drop the components required for this use case: <span class="bold"><strong>tFileInputDelimited</strong></span>, <span class="bold"><strong>tAggregateRow</strong></span>, <span class="bold"><strong>tLogRow</strong></span>
							and <span class="bold"><strong>tFileOutputDelimited</strong></span> from the
								<span class="bold"><strong>Palette</strong></span> to the design
							workspace.</p></li><li class="listitem"><p>Connect these components together using <span class="bold"><strong>Row</strong></span> &gt; <span class="bold"><strong>Main</strong></span> links.
						</p></li><li class="listitem"><p>Double-click the <span class="bold"><strong>tFileInputDelimited</strong></span>
							component to display its <span class="bold"><strong>Basic settings</strong></span>
							view. </p></li></ul></div><div class="mediaobject"><img src="../images/Use_Case_tAggregateRow8.png"></div><div class="warning" title="Warning" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Warning"><tr><td rowspan="2" align="center" valign="top" width="16pt"><img alt="[Warning]" src="../images/warning.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>
						<span class="italic">The dynamic schema feature is only supported in
								<span class="bold"><strong>Built-In</strong></span> mode and requires the
							input file to have a header row.</span>
					</p></td></tr></table></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Select <span class="bold"><strong>Built-In</strong></span> from the <span class="bold"><strong>Property Type</strong></span> list.</p></li><li class="listitem"><p>Click the <span class="bold"><strong>[...]</strong></span> button next to the
								<span class="bold"><strong>File Name</strong></span> field to browse to your
							input file. In this use case, we use a simple CSV file that has only
							three columns, as shown below: </p></li></ul></div><div class="mediaobject"><img src="../images/Use_Case_tAggregateRow9.png"></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Specify the header row in <span class="bold"><strong>Header</strong></span>
							field. In this use case the first row is the header row.</p></li><li class="listitem"><p>Select <span class="bold"><strong>Built-In</strong></span> from the <span class="bold"><strong>Schema</strong></span> list, and click <span class="bold"><strong>Edit schema</strong></span> to set the input schema.</p></li></ul></div><div class="mediaobject"><img src="../images/Use_Case_tAggregateRow10.png"></div><div class="warning" title="Warning" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Warning"><tr><td rowspan="2" align="center" valign="top" width="16pt"><img alt="[Warning]" src="../images/warning.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>
						<span class="emphasis"><em>The dynamic column must be defined in the last row of the
							schema.</em></span>
					</p></td></tr></table></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>In the schema editor, add two columns and name them
								<span class="emphasis"><em>Task</em></span> and <span class="emphasis"><em>Other</em></span>
							respectively. Set the data type of the <span class="emphasis"><em>Other</em></span> column
							to <span class="bold"><strong>Dynamic</strong></span> to retrieve all the columns
							undefined in the schema. </p></li><li class="listitem"><p>Click <span class="bold"><strong>OK</strong></span> to close the schema
							editor.</p></li><li class="listitem"><p>Double-click the <span class="bold"><strong>tAggregateRow</strong></span>
							component to display the <span class="bold"><strong>Basic settings</strong></span>
							view.</p></li></ul></div><div class="mediaobject"><img src="../images/Use_Case_tAggregateRow11.png"></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Click <span class="bold"><strong>Sync columns</strong></span> to reuse the input
							schema for the output row. If needed, click <span class="bold"><strong>Edit
								schema</strong></span> and rename the columns in the output schema. In
							this use case, we simply keep the schema as it is.</p></li><li class="listitem"><p>Add a row in the <span class="bold"><strong>Group by</strong></span> table by
							clicking the plus button, and select <span class="emphasis"><em>Other</em></span> in both
								<span class="bold"><strong>Output column</strong></span> and <span class="bold"><strong>Input column position</strong></span> fields to group the
							data entries by the dynamic column.</p></li></ul></div><div class="warning" title="Warning" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Warning"><tr><td rowspan="2" align="center" valign="top" width="16pt"><img alt="[Warning]" src="../images/warning.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>
						<span class="emphasis"><em>Dynamic column aggregation can be carried out only for the
							grouping operation. </em></span>
					</p></td></tr></table></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Add a row in the <span class="bold"><strong>Operations</strong></span> table by
							clicking the plus button, select <span class="emphasis"><em>Task</em></span> in both
								<span class="bold"><strong>Output column</strong></span> and <span class="bold"><strong>Input column position</strong></span> fields, and select
								<span class="emphasis"><em>list</em></span> in the <span class="bold"><strong>Function</strong></span> field so that all the entries of the
								<span class="emphasis"><em>Task</em></span> column are listed in the grouping
							result.</p></li><li class="listitem"><p>To view the output in the form of a table on the <span class="bold"><strong>Run</strong></span> console, double-click the <span class="bold"><strong>tLogRow</strong></span> component and select the <span class="bold"><strong>Table</strong></span> option in the <span class="bold"><strong>Basic
								settings</strong></span> view.</p></li><li class="listitem"><p>Double-click the <span class="bold"><strong>tFileOutputDelimited</strong></span>
							component to display its <span class="bold"><strong>Basic settings</strong></span>
							view.</p></li></ul></div><div class="mediaobject"><img src="../images/Use_Case_tAggregateRow14.png"></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Click the <span class="bold"><strong>[...]</strong></span> button next to the
								<span class="bold"><strong>File Name</strong></span> field to browse to the
							directory where you want to save the output file, and then enter a name
							for the file.</p></li><li class="listitem"><p>Select the<span class="bold"><strong> Include Header</strong></span> check box
							to retrieve the column names as well as the grouped data.</p></li><li class="listitem"><p>Save your Job and press <span class="bold"><strong>F6</strong></span> to run
							it.</p><p> As shown in the Job execution result, the data entries are grouped as
							per <span class="emphasis"><em>Team</em></span> and <span class="emphasis"><em>Status</em></span>.</p></li></ul></div><div class="mediaobject"><img src="../images/Use_Case_tAggregateRow16.png"></div></div></div></body></html>