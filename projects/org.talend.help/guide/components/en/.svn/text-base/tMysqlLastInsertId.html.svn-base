<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>tMysqlLastInsertId</title><meta name="generator" content="DocBook XSL-NS Stylesheets V1.76.1"><link rel="home" href="index.html" title="Talend Open Studio"><link rel="up" href="Raa29876.html" title="Chapter&nbsp;6.&nbsp;Database components"><link rel="prev" href="tMysqlInput.html" title="tMysqlInput"><link rel="next" href="tMysqlOutput.html" title="tMysqlOutput"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div lang="EN" class="section" title="tMysqlLastInsertId"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="tMysqlLastInsertId"></a>tMysqlLastInsertId</h2></div></div></div><div class="mediaobject"><img src="../images/tMSSqlLastInsertId_icon32.png"></div><a name="Xaa1605643"></a><div class="section" title="tMysqlLastInsertId properties"><div class="titlepage"><div><div><h3 class="title"><a name="d0e116781"></a>tMysqlLastInsertId properties</h3></div></div></div><div class="informaltable"><table border="1"><colgroup><col class="c1"><col class="c2"><col class="c3"></colgroup><tbody><tr><td valign="top">
									<p>
										<span class="bold"><strong>Component family</strong></span>
									</p>
								</td><td valign="top">
									<p>Databases</p>
								</td><td valign="top">&nbsp;</td></tr><tr><td valign="top">
									<p>
										<span class="bold"><strong>Function</strong></span>
									</p>
								</td><td colspan="2" valign="top">
									<p><span class="bold"><strong>tMysqlLastInsertId
										</strong></span>fetches the last inserted ID from a selected
										MySQL Connection.</p>
								</td></tr><tr><td valign="top">
									<p>
										<span class="bold"><strong>Purpose</strong></span>
									</p>
								</td><td colspan="2" valign="top">
									<p><span class="bold"><strong>tMysqlLastInsertId</strong></span>
										obtains the primary key value of the record that was last
										inserted in a Mysql table by a user.</p>
								</td></tr><tr><td valign="top">
									<p>
										<span class="bold"><strong>Basic settings</strong></span>
									</p>
								</td><td valign="top">
									<p><span class="emphasis"><em>Schema</em></span> and <span class="emphasis"><em>Edit
											Schema</em></span></p>
								</td><td valign="top">
									<p>A schema is a row description, i.e., it defines the number
										of fields to be processed and passed on to the next
										component. The schema is either built-in or stored remotely
										in the Repository. </p>
								</td></tr><tr><td>
									<p>&nbsp;</p>
								</td><td>
									<p>&nbsp;</p>
								</td><td valign="top">
									<p><span class="bold"><strong>Built-in</strong></span>: You create and
										store the schema locally for this component only. Related
										topic: see <span class="bluebold">Talend Open Studio</span>
										<span class="bold"><strong>User Guide</strong></span>.</p>
								</td></tr><tr><td>
									<p>&nbsp;</p>
								</td><td>
									<p>&nbsp;</p>
								</td><td valign="top">
									<p><span class="bold"><strong>Repository</strong></span>: You have
										already created the schema and stored it in the Repository.
										You can reuse it in various projects and job flow charts.
										Related topic: see <span class="bluebold">Talend Open Studio</span>
										<span class="bold"><strong>User Guide</strong></span>.</p>
								</td></tr><tr><td>
									<p>&nbsp;</p>
								</td><td valign="top">
									<p>
										<span class="emphasis"><em>Component list</em></span>
									</p>
								</td><td valign="top">
									<p>Select the relevant <span class="bold"><strong>tMysqlConnection</strong></span> component in the list if
										more than one connection is planned for the current
										job.</p>
								</td></tr><tr><td valign="top">
									<p>
										<span class="bold"><strong>Usage</strong></span>
									</p>
								</td><td colspan="2" valign="top">
									<p>This component is to be used as an intermediary component. </p>
									<div class="warning" title="Warning" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Warning"><tr><td rowspan="2" align="center" valign="top" width="16pt"><img alt="[Warning]" src="../images/warning.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>
											<span class="italic"> If you use this component with
												<span class="bold"><strong>tMySqlOutput</strong></span>,
												verify that the <span class="bold"><strong>Extend
												Insert</strong></span> check box in the <span class="bold"><strong>Advanced Settings</strong></span> tab is
												not selected. <span class="bold"><strong>Extend
												Insert</strong></span> allows you to make a batch
												insertion, however, if the check box is selected,
												only the ID of the last line in the last batch will
												be returned.</span>
										</p></td></tr></table></div>
								</td></tr><tr><td valign="top">
									<p>
										<span class="bold"><strong>Limitation</strong></span>
									</p>
								</td><td colspan="2" valign="top">
									<p>n/a</p>
								</td></tr></tbody></table></div></div><div class="section" title="Scenario: Get the ID for the last inserted record"><div class="titlepage"><div><div><h3 class="title"><a name="Raa19820"></a>Scenario: Get the ID for the last inserted record</h3></div></div></div><p>The following Java scenario creates a job that opens a connection to Mysql
					database, writes the defined data into the database, and finally fetches the
					last inserted ID on the existing connection.</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p> Drop the following components from the <span class="bold"><strong>Palette</strong></span> onto the design workspace: <span class="bold"><strong>tMySqlConnection</strong></span>, <span class="bold"><strong>tMySqlCommit</strong></span>, <span class="bold"><strong>tFileInputDelimited</strong></span>, <span class="bold"><strong>tMySqlOutput</strong></span>, <span class="bold"><strong>tMysqlLastInsertId</strong></span>, and <span class="bold"><strong>tLogRow</strong></span>.</p></li><li class="listitem"><p> Connect <span class="bold"><strong>tMySqlConnection</strong></span> to
								<span class="bold"><strong>tFileInputDelimited </strong></span>using an
								<span class="bold"><strong>OnSubjobOk </strong></span>link.</p></li><li class="listitem"><p> Connect <span class="bold"><strong>tFileInputDelimited </strong></span>to
								<span class="bold"><strong>tMySqlCommit</strong></span> using an <span class="bold"><strong>OnSubjobOk </strong></span>link.</p></li><li class="listitem"><p> Connect <span class="bold"><strong>tFileInputdelimited </strong></span>to the
							three other components using <span class="bold"><strong>Row Main
							</strong></span>links.</p></li></ul></div><div class="mediaobject"><img src="../images/Use_Case_tMysqlLastInsertId.png"></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p> In the design workspace, select <span class="bold"><strong>tMysqlConnection</strong></span>.</p></li><li class="listitem"><p> Click the <span class="bold"><strong>Component</strong></span> tab to define
							the basic settings for <span class="bold"><strong>tMysqlConnection</strong></span>.</p></li><li class="listitem"><p> In the <span class="bold"><strong>Basic settings</strong></span> view, set the
							connection details manually or select them from the context variable
							list, through a <span class="bold"><strong>Ctrl+Space</strong></span> click in the
							corresponding field if you stored them locally as Metadata DB connection
							entries. For more information about Metadata, see <span class="bluebold">Talend Open Studio</span>
							<span class="bold"><strong>User Guide</strong></span>.</p></li></ul></div><div class="mediaobject"><img src="../images/Use_Case_tMysqlLastInsertId1.png"></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p> In the design workspace, select <span class="bold"><strong>tMysqlCommit</strong></span> and click the <span class="bold"><strong>Component</strong></span> tab to define its basic settings.</p></li><li class="listitem"><p> On the <span class="bold"><strong>Component List</strong></span>, select the
							relevant <span class="bold"><strong>tMysqlConnection</strong></span> if more than
							one connection is used.</p></li><li class="listitem"><p> In the design workspace, select <span class="bold"><strong>tFileInputDelimited</strong></span>.</p></li><li class="listitem"><p> Click the <span class="bold"><strong>Component</strong></span> tab to define
							the basic settings of <span class="bold"><strong>tFileInputDelimited</strong></span>.</p></li></ul></div><div class="mediaobject"><img src="../images/Use_Case_tMysqlLastInsertId2.png"></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p> Set <span class="bold"><strong>Property Type</strong></span> to <span class="bold"><strong>Built-In</strong></span>.</p></li><li class="listitem"><p> Fill in a path to the processed file in the <span class="bold"><strong>File Name</strong></span> field. The file used in this example is
								<span class="emphasis"><em>Customers</em></span>.</p></li><li class="listitem"><p> Define the <span class="bold"><strong>Row separator</strong></span> that allow
							to identify the end of a row. Then define the <span class="bold"><strong>Field separator</strong></span> used to delimit fields in a row.</p></li><li class="listitem"><p> Set the header, the footer and the number of processed rows as
							necessary. In this scenario, we have one header.</p></li><li class="listitem"><p> Set <span class="bold"><strong>Schema</strong></span> to <span class="bold"><strong>Built in</strong></span> and click the three-dot button next to
								<span class="bold"><strong>Edit Schema </strong></span>to define the data to
							pass on to the next component. </p></li></ul></div><p>Related topics: see <span class="bluebold">Talend Open Studio</span>
					<span class="bold"><strong>User Guide</strong></span>.</p><div class="mediaobject"><img src="../images/Use_Case_tMysqlLastInsertId3.png"></div><p>In this scenario, the schema consists of two columns,
						<span class="emphasis"><em>name</em></span> and <span class="emphasis"><em>age</em></span>. The first holds
					three employees&#8217; names and the second holds the corresponding age for
					each.</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p> In the design workspace, select <span class="bold"><strong>tMySqlOutput</strong></span>.</p></li><li class="listitem"><p> Click the <span class="bold"><strong>Component</strong></span> tab to define
							the basic settings of <span class="bold"><strong>tMySqlOuptput</strong></span>.</p></li></ul></div><div class="mediaobject"><img src="../images/Use_Case_tMysqlLastInsertId4.png"></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p> Select the <span class="bold"><strong>Use an existing
								connection</strong></span> check box.</p></li><li class="listitem"><p> In the <span class="bold"><strong>Table</strong></span> field, enter the name
							of the table where to write the employees&#8217; list, in this example:
								<span class="emphasis"><em>employee</em></span>. </p></li><li class="listitem"><p> Select relevant actions on the <span class="bold"><strong>Action on table
							</strong></span>and <span class="bold"><strong>Action on data</strong></span> lists. In
							this example, no action is carried out on table, and the action carried
							out on data is <span class="emphasis"><em>Insert</em></span>. </p></li><li class="listitem"><p> Set <span class="bold"><strong>Schema</strong></span> to <span class="bold"><strong>Built-In</strong></span> and click <span class="bold"><strong>Sync
								columns</strong></span> to synchronize columns with the previous
							component. In this example, the schema to be inserted into the MySql
							database table consists of the two columns<span class="emphasis"><em> name</em></span>
								and<span class="emphasis"><em> age</em></span>.</p></li></ul></div><div class="mediaobject"><img src="../images/Use_Case_tMysqlLastInsertId5.png"></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p> In the design workspace, select <span class="bold"><strong>tMySqlLastInsertId</strong></span>.</p></li><li class="listitem"><p> Click the <span class="bold"><strong>Component</strong></span> tab to define
							the basic settings of <span class="bold"><strong>tMySqlLastInserId</strong></span>.</p></li></ul></div><div class="mediaobject"><img src="../images/Use_Case_tMysqlLastInsertId6.png"></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p> On the <span class="bold"><strong>Component List</strong></span>, select the
							relevant <span class="bold"><strong>tMysqlConnection</strong></span>, if more than
							one connection is used.</p></li><li class="listitem"><p> Set <span class="bold"><strong>Schema</strong></span> to <span class="bold"><strong>Built-In</strong></span> and click <span class="bold"><strong>Sync columns
							</strong></span>to synchronize columns with the previous component. In the
							output schema of <span class="bold"><strong>tMySqlLastInsertId</strong></span>,
							you can see the read-only column<span class="emphasis"><em> last_insert_id</em></span>
							that will fetch the last inserted ID on the existing connection.</p></li></ul></div><div class="mediaobject"><img src="../images/Use_Case_tMysqlLastInsertId7.png"></div><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="16pt"><img alt="[Note]" src="../images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>You can select the data type <span class="italic">Long</span> from
						the <span class="bold"><strong>Type</strong></span> drop-down list in case of a huge
						number of entries.</p></td></tr></table></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p> In the design workspace, select <span class="bold"><strong>tLogRow</strong></span> and click the <span class="bold"><strong>Component</strong></span> tab to define its basic settings. For more
							information, see <a class="xref" href="tLogRow.html" title="tLogRow">the section called &#8220;tLogRow&#8221;</a>.</p></li><li class="listitem"><p> Save your job and press <span class="bold"><strong>F6</strong></span> to
							execute it.</p></li></ul></div><div class="mediaobject"><img src="../images/Use_Case_tMysqlLastInsertId8.png"></div><p><span class="bold"><strong>tMysqlLastInsertId </strong></span>fetched the last inserted
					ID for each line on the existing connection.</p></div></div></body></html>